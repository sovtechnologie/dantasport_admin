import{r as g,j as w,a0 as b}from"./index-XzM8Cj3c.js";import{I as E}from"./index-Vt2X7eqz.js";function x(d){const[n,s]=g.useState(!1);return g.useEffect(()=>{if(window.google&&window.google.maps){s(!0);return}const l=document.getElementById("google-maps-script");if(l){l.addEventListener("load",()=>s(!0));return}const e=document.createElement("script");return e.id="google-maps-script",e.src=`https://maps.googleapis.com/maps/api/js?key=${d}&libraries=places`,e.async=!0,e.defer=!0,e.onload=()=>s(!0),e.onerror=()=>{console.error("Failed to load Google Maps script"),s(!1)},document.body.appendChild(e),()=>{e&&e.removeEventListener("load",()=>s(!0))}},[d]),n}function I(d){if(!d)return null;const n=decodeURIComponent(d),s=n.match(/[?&]place_id=([^&]+)/);if(s)return{placeId:s[1]};const l=n.match(/!3d([-\d.]+)!4d([-\d.]+)/);if(l)return{lat:parseFloat(l[1]),lng:parseFloat(l[2])};const e=n.match(/@([-\d.]+),([-\d.]+)/);if(e)return{lat:parseFloat(e[1]),lng:parseFloat(e[2])};const a=n.match(/\/([-\d.]+),([-\d.]+)/);return a?{lat:parseFloat(a[1]),lng:parseFloat(a[2])}:null}const M=({value:d,onChange:n,onPlaceSelect:s,placeholder:l})=>{const e=g.useRef(null),a=g.useRef(null),m=x("AIzaSyA2otw_MlUBXXfpinfgDEuJQoiqSRoYElg"),t=(o,r)=>{const i=o.find(y=>y.types.includes(r));return i?i.long_name:""};g.useEffect(()=>{if(m&&!(!e.current||!e.current.input))return a.current&&window.google.maps.event.clearInstanceListeners(a.current),a.current=new window.google.maps.places.Autocomplete(e.current.input,{componentRestrictions:{country:"in"},fields:["formatted_address","geometry","address_component"],types:["address"]}),a.current.addListener("place_changed",()=>{const o=a.current.getPlace();if(!o.geometry){console.error("No geometry data for selected place");return}const r=o.address_components;s({address:o.formatted_address,latitude:o.geometry.location.lat(),longitude:o.geometry.location.lng(),area:t(r,"sublocality_level_1")||t(r,"sublocality")||"",city:t(r,"locality")||t(r,"sublocality")||"",state:t(r,"administrative_area_level_1")||"",pincode:t(r,"postal_code")||""})}),()=>{a.current&&window.google.maps.event.clearInstanceListeners(a.current)}},[m,s]);const v=async({placeId:o,lat:r,lng:i})=>{if(!window.google)return;const y=new window.google.maps.places.PlacesService(document.createElement("div"));o?y.getDetails({placeId:o,fields:["formatted_address","geometry","address_component"]},(p,f)=>{if(f===window.google.maps.places.PlacesServiceStatus.OK){const c=p.address_components;s({address:p.formatted_address,latitude:p.geometry.location.lat(),longitude:p.geometry.location.lng(),area:t(c,"sublocality_level_1")||t(c,"sublocality")||"",city:t(c,"locality")||t(c,"sublocality")||"",state:t(c,"administrative_area_level_1")||"",pincode:t(c,"postal_code")||""})}}):r&&i&&new window.google.maps.Geocoder().geocode({location:{lat:r,lng:i}},(f,c)=>{if(c==="OK"&&f.length){const _=f[0],u=_.address_components;s({address:_.formatted_address,latitude:r,longitude:i,area:t(u,"sublocality_level_1")||t(u,"sublocality")||"",city:t(u,"locality")||t(u,"sublocality")||"",state:t(u,"administrative_area_level_1")||"",pincode:t(u,"postal_code")||""})}})},h=o=>{n&&n(o);const r=I(o.target.value);console.log("Parsing result:",r),r&&m&&v(r)};return m?w.jsx(E,{value:d,onChange:h,placeholder:l,style:{width:"100%",padding:"6px 11px",borderRadius:4,border:"1px solid #d9d9d9",outline:"none"},onFocus:o=>o.target.style.borderColor="#40a9ff",onBlur:o=>o.target.style.borderColor="#d9d9d9",ref:e}):w.jsx(b,{})};export{M as G};
