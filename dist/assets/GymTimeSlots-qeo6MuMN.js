import{a as te,b as ie,r,j as e,a0 as N,B as b,bX as g,a4 as C,T as j,S as ae,a2 as U,m as le}from"./index-XzM8Cj3c.js";/* empty css               */import{a as oe}from"./useFetchvendorVenues-D949lnpY.js";import{u as re}from"./useQuery-Beh9q-Hu.js";import{k as ne,l as de}from"./endpointApi-DBrVeqMh.js";import{h as m}from"./moment-C5S46NFB.js";import{s as y}from"./index-Yvuj0Esb.js";import{S as D}from"./index-Ci-vNBFy.js";import{R as V}from"./PlusOutlined-Dj0tFLrA.js";import{R as xe,C as T}from"./row-CTTWbxgc.js";import{C as c}from"./index-C1XA4k9t.js";import{S as k}from"./index-CCwbS7V6.js";import{a as G,R as P}from"./ThunderboltOutlined-BG6SsWoO.js";import{F as ce,P as pe}from"./Table-Dv9gfO7j.js";import{B as ge}from"./index-D8JKXGq0.js";import{T as me}from"./index-B9zQjaED.js";import{P as ye}from"./progress-DW_vC4dS.js";import{R as he}from"./DeleteOutlined-Ke0rSpX_.js";import"./useMutation-CNNl5TnA.js";import"./ExclamationCircleFilled-D7dRXMD9.js";import"./InfoCircleFilled-Ce5_6Fhy.js";import"./SearchOutlined-B0571LVy.js";import"./index-BfZvbS5e.js";import"./Skeleton-BxJpOdZN.js";import"./addEventListener-kraIZfrw.js";import"./index-V8rTfzId.js";import"./useBubbleLock-B-1WFybW.js";import"./index-BZS9dDwd.js";import"./useForm-EwlPOCpB.js";import"./extendsObject-78o_rR5W.js";import"./Input-BUj1c9yh.js";import"./useClosable-B4NhgZhJ.js";const fe=({gymId:a})=>re({queryKey:["gymTimeSlots",a],queryFn:()=>ne({gymId:a}),enabled:!!a,staleTime:5*60*1e3,cacheTime:10*60*1e3,retry:2,onError:n=>{console.error("Failed to fetch gym time slots:",n)}}),{Option:Z}=D,ue=a=>{const n=[];return a.monday&&n.push("Monday"),a.tuesday&&n.push("Tuesday"),a.wednesday&&n.push("Wednesday"),a.thursday&&n.push("Thursday"),a.friday&&n.push("Friday"),a.saturday&&n.push("Saturday"),a.sunday&&n.push("Sunday"),n.join(", ")};function Ze(){const a=te(),n=ie(s=>s.auth.user.id),[i,L]=r.useState(null),[$,E]=r.useState(1),[S,be]=r.useState(4),[A,q]=r.useState(!1),[v,K]=r.useState(!1),[I,O]=r.useState(null),{data:d,isLoading:h,isFetching:je,error:Q}=oe(n),{data:f,isLoading:R,isFetching:_,error:J,refetch:w}=fe({gymId:i});r.useEffect(()=>{d?.result?.length&&!i&&L(d.result[0].Id)},[d,i]),r.useEffect(()=>{i&&w()},[i,w]);const X=s=>{q(!0),L(s),E(1),setTimeout(()=>{q(!1)},500)};r.useEffect(()=>{Q&&y.error("Failed to load gym list"),J&&y.error("Failed to load gym time slots list")},[Q,J]);const Y=r.useMemo(()=>d?.result?.find(s=>s.Id===i),[d?.result,i]),o=r.useMemo(()=>f?.result?f.result.map(s=>({id:s.id,gym_id:s.gym_id,start_time:s.start_time,end_time:s.end_time,days_schedule:s.days_schedule,monday:s.monday,tuesday:s.tuesday,wednesday:s.wednesday,thursday:s.thursday,friday:s.friday,saturday:s.saturday,sunday:s.sunday,created_at:s.created_at,updated_at:s.updated_at,raw:s})):[],[f?.result]),z=r.useMemo(()=>{if(!o.length)return{total:0,daily:0,custom:0,totalHours:0};const s=o.filter(x=>x.days_schedule===1).length,t=o.filter(x=>x.days_schedule===0).length,l=o.reduce((x,p)=>{const H=m(p.start_time,"HH:mm:ss"),B=m(p.end_time,"HH:mm:ss"),M=m.duration(B.diff(H));return x+M.asHours()},0);return{total:o.length,daily:s,custom:t,totalHours:Math.round(l*10)/10}},[o]),u=($-1)*S,W=o.slice(u,u+S),F=r.useCallback(()=>{if(!i){y.warning("Please select a gym first");return}a("/vendor/gym/addtimeslot")},[i,a]),ee=r.useCallback(s=>{const t=o.find(l=>l.id===s);t?a(`/vendor/gym/edittimeslot/${s}`,{state:{timeSlotData:t,timeSlotId:s}}):a(`/vendor/gym/edittimeslot/${s}`)},[a,o]),se=r.useCallback(async s=>{try{O(s.id),K(!0);const t={gymTimeSlotId:s.id},l=await de(t);l.status===200||l.status===201?(y.success("Gym time slot deleted successfully"),await w()):y.error(l.message||"Failed to delete gym time slot")}catch(t){console.error("❌ Failed to delete time slot:",t),y.error(t?.response?.data?.message||"Failed to delete gym time slot")}finally{O(null),K(!1)}},[w]);return h?e.jsx("div",{className:"venue-card",children:e.jsxs("div",{className:"page-loading-container",children:[e.jsx(N,{size:"large"}),e.jsx("div",{className:"page-loading-text",children:"Loading gyms..."})]})}):!i||A||i&&R||i&&!f?e.jsxs("div",{className:"venue-card",children:[e.jsxs("div",{className:"venue-toolbar",children:[e.jsx(D,{placeholder:"Select Gym",className:"venue-select",loading:h,onChange:X,value:i||void 0,disabled:h||!d?.result?.length,children:d?.result?.map(s=>e.jsx(Z,{value:s.Id,children:s.gym_name},s.Id))}),e.jsx(b,{type:"primary",className:"add-btn",disabled:!i,onClick:F,children:"+ Add Time Slot"})]}),e.jsx("h3",{className:"venue-title",children:Y?.gym_name||"Select a gym to view time slots"}),e.jsxs("div",{className:"page-loading-container",children:[e.jsx(N,{size:"large"}),e.jsx("div",{className:"page-loading-text",children:i?A?"Switching gym...":i&&!f?"Fetching gym time slots...":"Loading time slots...":"Please select a gym to view time slots"})]})]}):e.jsxs("div",{className:"venue-card",children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"16px",padding:"24px",marginBottom:"24px",color:"white",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.3)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsxs("h2",{style:{margin:0,fontSize:"28px",fontWeight:"700",color:"white",display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(g,{style:{fontSize:"32px"}}),"Time Slot Management"]}),e.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"16px",opacity:.9,color:"white"},children:"Manage your gym's operating hours and availability"})]}),e.jsxs(b,{type:"primary",size:"large",icon:e.jsx(V,{}),disabled:!i||v||_,onClick:F,style:{background:"rgba(255, 255, 255, 0.2)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"white",height:"48px",padding:"0 24px",borderRadius:"12px",fontWeight:"600",fontSize:"16px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},children:["Add Time Slot",v&&e.jsx("span",{style:{marginLeft:"8px",opacity:.8},children:"(Processing...)"})]})]}),e.jsx("div",{style:{marginBottom:"20px"},children:e.jsx(D,{placeholder:"Select Gym",size:"large",loading:h,onChange:X,value:i||void 0,disabled:h||!d?.result?.length,style:{width:"300px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"8px"},children:d?.result?.map(s=>e.jsx(Z,{value:s.Id,children:s.gym_name},s.Id))})}),i&&o.length>0&&e.jsxs(xe,{gutter:[16,16],children:[e.jsx(T,{xs:24,sm:12,md:6,children:e.jsx(c,{size:"small",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px"},bodyStyle:{padding:"16px"},children:e.jsx(k,{title:e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"14px"},children:"Total Slots"}),value:z.total,valueStyle:{color:"white",fontSize:"24px",fontWeight:"700"},prefix:e.jsx(g,{})})})}),e.jsx(T,{xs:24,sm:12,md:6,children:e.jsx(c,{size:"small",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px"},bodyStyle:{padding:"16px"},children:e.jsx(k,{title:e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"14px"},children:"Daily Slots"}),value:z.daily,valueStyle:{color:"#52c41a",fontSize:"24px",fontWeight:"700"},prefix:e.jsx(G,{})})})}),e.jsx(T,{xs:24,sm:12,md:6,children:e.jsx(c,{size:"small",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px"},bodyStyle:{padding:"16px"},children:e.jsx(k,{title:e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"14px"},children:"Custom Slots"}),value:z.custom,valueStyle:{color:"#1890ff",fontSize:"24px",fontWeight:"700"},prefix:e.jsx(P,{})})})}),e.jsx(T,{xs:24,sm:12,md:6,children:e.jsx(c,{size:"small",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px"},bodyStyle:{padding:"16px"},children:e.jsx(k,{title:e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.8)",fontSize:"14px"},children:"Total Hours"}),value:z.totalHours,valueStyle:{color:"#faad14",fontSize:"24px",fontWeight:"700"},suffix:"hrs"})})})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"24px",padding:"0 4px"},children:[e.jsxs("h3",{style:{margin:0,fontSize:"24px",fontWeight:"600",color:"#1f2937",display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(C,{style:{color:"#1163C7",fontSize:"20px"}}),Y?.gym_name||"Select a gym to view time slots",_&&!R&&e.jsx(N,{size:"small",style:{marginLeft:8}})]}),i&&o.length>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",background:"#f0f9ff",borderRadius:"20px",border:"1px solid #e0f2fe"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#10b981"}}),e.jsxs("span",{style:{fontSize:"14px",color:"#059669",fontWeight:"500"},children:[o.length," Active Slots"]})]})]}),e.jsx("div",{className:"members-table-container",children:W?.length>0?e.jsx(c,{style:{borderRadius:"16px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",border:"1px solid #f0f0f0"},bodyStyle:{padding:"0"},children:e.jsx(ce,{dataSource:W,columns:[{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontWeight:"600",color:"#1f2937"},children:[e.jsx(g,{style:{color:"#1163C7"}}),"Time Slot"]}),key:"timeSlot",width:320,render:(s,t,l)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"8px 0"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"16px",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:e.jsx(g,{style:{fontSize:"20px",color:"white"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsxs(j.Text,{strong:!0,style:{fontSize:"16px",color:"#1f2937"},children:["Time Slot #",t.id]}),e.jsx(ge,{count:u+l+1,style:{backgroundColor:"#1163C7",fontSize:"10px",fontWeight:"600"},size:"small"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsxs(j.Text,{type:"secondary",style:{fontSize:"14px",fontWeight:"500",color:"#6b7280"},children:[t.start_time," - ",t.end_time]}),e.jsx(me,{color:t.days_schedule===1?"blue":"green",style:{borderRadius:"6px",fontSize:"10px",fontWeight:"500",margin:0},children:t.days_schedule===1?"Daily":"Custom"})]})]})]})},{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontWeight:"600",color:"#1f2937"},children:[e.jsx(C,{style:{color:"#1163C7"}}),"Active Days"]}),key:"days",width:280,render:(s,t)=>e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx(C,{style:{color:"#1163C7",fontSize:"16px"}}),e.jsx(j.Text,{style:{fontSize:"14px",fontWeight:"500",color:"#374151"},children:ue(t)})]}),e.jsx("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:[{key:"monday",label:"M",value:t.monday},{key:"tuesday",label:"T",value:t.tuesday},{key:"wednesday",label:"W",value:t.wednesday},{key:"thursday",label:"T",value:t.thursday},{key:"friday",label:"F",value:t.friday},{key:"saturday",label:"S",value:t.saturday},{key:"sunday",label:"S",value:t.sunday}].map(l=>e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"6px",background:l.value?"#1163C7":"#f3f4f6",color:l.value?"white":"#9ca3af",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"600"},children:l.label},l.key))})]})},{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontWeight:"600",color:"#1f2937"},children:[e.jsx(P,{style:{color:"#1163C7"}}),"Duration"]}),key:"duration",width:140,render:(s,t)=>{const l=m(t.start_time,"HH:mm:ss"),x=m(t.end_time,"HH:mm:ss"),p=m.duration(x.diff(l)),H=Math.floor(p.asHours()),B=p.minutes(),M=p.asMinutes();return e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx(g,{style:{color:"#1163C7",fontSize:"16px"}}),e.jsxs(j.Text,{style:{fontSize:"16px",fontWeight:"600",color:"#1f2937"},children:[H,"h ",B,"m"]})]}),e.jsx(ye,{percent:Math.min(M/1440*100,100),size:"small",showInfo:!1,strokeColor:{"0%":"#667eea","100%":"#764ba2"},style:{marginTop:"4px"}})]})}},{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontWeight:"600",color:"#1f2937"},children:[e.jsx(G,{style:{color:"#1163C7"}}),"Actions"]}),key:"actions",width:120,render:(s,t)=>e.jsx("div",{style:{padding:"8px 0"},children:e.jsxs(ae,{size:"small",children:[e.jsx(U,{title:"Edit Time Slot",children:e.jsx(b,{type:"text",icon:e.jsx(le,{}),size:"small",disabled:v,onClick:()=>ee(t.id),style:{width:"32px",height:"32px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",background:"#f0f9ff",border:"1px solid #e0f2fe",color:"#1163C7"}})}),e.jsx(U,{title:I===t.id?"Deleting...":"Delete Time Slot",children:e.jsx(b,{type:"text",danger:!0,icon:e.jsx(he,{}),size:"small",loading:I===t.id,disabled:I===t.id||v,onClick:()=>se(t),style:{width:"32px",height:"32px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",background:"#fef2f2",border:"1px solid #fecaca",color:"#dc2626"}})})]})})}],pagination:!1,rowKey:"id",size:"middle",loading:R||_,style:{background:"white"},rowClassName:(s,t)=>`time-slot-row ${t%2===0?"even-row":"odd-row"}`})}):e.jsx(c,{style:{borderRadius:"16px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",border:"1px solid #f0f0f0",textAlign:"center",padding:"60px 40px"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:"500px",margin:"0 auto"},children:[e.jsx("div",{style:{width:"120px",height:"120px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"24px",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.3)"},children:e.jsx(g,{style:{fontSize:"48px",color:"white"}})}),e.jsx("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#1f2937",margin:"0 0 12px 0"},children:"No Time Slots Configured"}),e.jsx("p",{style:{fontSize:"16px",color:"#6b7280",margin:"0 0 32px 0",lineHeight:"1.6"},children:"This gym doesn't have any operating time slots yet. Create time slots to define when your gym is available for bookings."}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px",width:"100%",marginBottom:"32px"},children:[e.jsxs("div",{style:{padding:"16px",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx(P,{style:{color:"#1163C7",fontSize:"16px"}}),e.jsx("span",{style:{fontWeight:"600",color:"#374151"},children:"Flexible Hours"})]}),e.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280"},children:"Set custom start and end times"})]}),e.jsxs("div",{style:{padding:"16px",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx(C,{style:{color:"#1163C7",fontSize:"16px"}}),e.jsx("span",{style:{fontWeight:"600",color:"#374151"},children:"Multiple Days"})]}),e.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280"},children:"Choose specific days or all days"})]}),e.jsxs("div",{style:{padding:"16px",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx(G,{style:{color:"#1163C7",fontSize:"16px"}}),e.jsx("span",{style:{fontWeight:"600",color:"#374151"},children:"Peak Management"})]}),e.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280"},children:"Optimize your gym's availability"})]})]}),e.jsx(b,{type:"primary",size:"large",icon:e.jsx(V,{}),onClick:F,disabled:!i,style:{height:"48px",padding:"0 32px",borderRadius:"12px",fontWeight:"600",fontSize:"16px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:"Create Your First Time Slot"})]})})}),W?.length>0&&e.jsx(c,{style:{marginTop:"24px",borderRadius:"16px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",border:"1px solid #f0f0f0"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#10b981"}}),e.jsxs(j.Text,{style:{fontSize:"14px",color:"#6b7280",fontWeight:"500"},children:["Showing ",u+1,"-",Math.min(u+S,o.length)," of ",o.length," time slots"]})]}),e.jsx(pe,{current:$,pageSize:S,total:o.length,onChange:s=>E(s),showSizeChanger:!1,showQuickJumper:!1,showTotal:(s,t)=>`${t[0]}-${t[1]} of ${s} time slots`,style:{margin:0}})]})})]})}export{Ze as default};
