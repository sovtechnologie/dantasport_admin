import{a as R,r as d,j as e,B as c}from"./index-XzM8Cj3c.js";/* empty css                  */import{u as x}from"./UploadIcon-DVASWBXr.js";import{u as y}from"./useMutation-CNNl5TnA.js";import{a as z,b as H,C as J,A as Q}from"./endpointApi-CicnUymp.js";import{F as t}from"./index-BLf5ALDk.js";import{R as A,C as b}from"./row-CTTWbxgc.js";import{I as i}from"./index-Vt2X7eqz.js";import{S}from"./index-Ci-vNBFy.js";import{U as j}from"./index-DpVHb5nB.js";import{s as l}from"./index-Yvuj0Esb.js";import"./useForm-EwlPOCpB.js";import"./ExclamationCircleFilled-D7dRXMD9.js";import"./index-BfZvbS5e.js";import"./Input-BUj1c9yh.js";import"./SearchOutlined-B0571LVy.js";import"./EyeOutlined-BVmecd_y.js";import"./fade-_qbex92f.js";import"./DeleteOutlined-Ke0rSpX_.js";import"./DownloadOutlined-D_mskBw8.js";import"./progress-DW_vC4dS.js";import"./InfoCircleFilled-Ce5_6Fhy.js";const W=()=>y({mutationKey:["SendOtp"],mutationFn:s=>{if(!s)throw new Error("payload is required");return console.log("in mutation section payload",s),z(s)},onSuccess:s=>(console.log("OTP sent successfully:",s),s),onError:s=>(console.error("Failed to send OTP:",s),s)}),X=()=>y({mutationKey:["VerifyOtp"],mutationFn:s=>{if(!s)throw new Error("payload is required");return console.log("in mutation section payload",s),H(s)},onSuccess:s=>(console.log("OTP verify successfully:",s),s),onError:s=>(console.error("Failed to verify OTP:",s),s)}),Y=()=>y({mutationKey:["CreateVendor"],mutationFn:s=>{if(!s)throw new Error("Payload is required to create a vendor");return J(s)},onSuccess:s=>{console.log("Vendor created successfully",s)},onError:s=>{console.error("Error creating vendor",s)}}),_=()=>y({mutationKey:["addBankDetails"],mutationFn:s=>{if(!s)throw new Error("Payload is required to add bank details");return Q(s)},onSuccess:s=>{console.log("Bank details added successfully",s)},onError:s=>{console.error("Failed to add bank details",s)}}),{Option:u}=S,Oe=()=>{const s=R(),[o]=t.useForm(),[I,N]=d.useState(!1),[k,O]=d.useState(!1),[T,P]=d.useState(!1),[V,h]=d.useState(!1),[F,g]=d.useState(null),[f,C]=d.useState(null),[v,p]=d.useState(null),{mutate:q}=W(),L=()=>{const r=o.getFieldValue("mobile");if(!r){l.error("Please enter a mobile number before sending OTP");return}P(!0),g(null),q({vendorMobileNumber:r},{onSuccess:n=>{P(!1),n?.status===200&&(l.success(n.message||"OTP sent successfully"),C(n?.result?.id),N(!0),g(null),o.setFields([{name:"mobile",errors:[]}]),o.setFieldsValue({otp:n?.result?.otp||""}))},onError:n=>{P(!1);const a=n?.response?.data?.message||n?.message||"Failed to send OTP";n?.response?.status===409?(console.log("error catch with status409",a),g(a),o.setFields([{name:"mobile",errors:[a]}]),o.validateFields(["mobile"]).catch(()=>{})):l.error(a)}})},B=r=>{g(null),N(!1),o.setFields([{name:"mobile",errors:[]}])},{mutate:U}=X(),w=()=>{const r=o.getFieldValue("otp");if(!f){l.error("Please send OTP first");return}if(!r){l.error("Please enter OTP");return}h(!0),p(null);const n=Number(r);if(isNaN(n)){l.error("OTP must be a numeric value"),h(!1);return}U({id:f,otp:n},{onSuccess:a=>{h(!1),a?.status===200&&(l.success(a.message||"OTP verified successfully"),p(null),O(!0))},onError:a=>{h(!1);const m=a?.response?.data?.message||a?.message||"OTP verification failed";a?.response?.status===409?(console.log("error catch with status 409",m),p(m),o.setFields([{name:"otp",errors:[m]}]),o.validateFields(["otp"]).catch(()=>{})):l.error(m)}})},Z=()=>{p(null),O(!1),o.setFields([{name:"mobile",errors:[]}])},{mutate:M,isLoading:D}=Y(),{mutate:K,isLoading:E}=_(),G=r=>{const n={vendorId:f,vendorName:r.vendorName,services:r.services,vendorEmail:r.email},a=new FormData;a.append("vendorId",f),a.append("gstNumber",r.gstNumber),a.append("panNumber",r.pancardNumber),a.append("accountNumber",r.accountNumber),a.append("bankName",r.bankName),a.append("ifscCode",r.ifscCode),a.append("aadharNumber",r.aadharNumber),r.gstDocument?.fileList?.[0]?.originFileObj&&a.append("gstDoc",r.gstDocument.fileList[0].originFileObj),r.pancardDoc?.fileList?.[0]?.originFileObj&&a.append("panDoc",r.pancardDoc.fileList[0].originFileObj),r.bankDoc?.fileList?.[0]?.originFileObj&&a.append("bankPassBook",r.bankDoc.fileList[0].originFileObj),r.aadharDoc?.fileList?.[0]?.originFileObj&&a.append("aadharDoc",r.aadharDoc.fileList[0].originFileObj),M(n,{onSuccess:m=>{l.success("Vendor created successfully"),K(a,{onSuccess:()=>{l.success("Bank details added successfully"),o.resetFields(),N(!1),O(!1),C(null),p(null),s("/admin/vendors")},onError:$=>{l.error("Failed to add bank details",$)}})},onError:m=>{l.error("Failed to create vendor")}})};return e.jsx("div",{className:"vendor-form-wrapper",children:e.jsxs(t,{form:o,layout:"vertical",onFinish:G,className:"vendor-form",children:[e.jsxs(A,{gutter:24,children:[e.jsxs(b,{span:12,children:[e.jsx("h3",{children:"Basic Information"}),e.jsx(t.Item,{label:"Enter Vendor Name",name:"vendorName",rules:[{required:!0}],children:e.jsx(i,{})}),e.jsx(t.Item,{label:"Enter Mobile Number",name:"mobile",validateStatus:F?"error":"",help:F||void 0,rules:[{required:!0,message:"Please enter mobile number"},{pattern:/^[0-9]+$/,message:"Mobile number must contain only digits"},{len:10,message:"Mobile number must be exactly 10 digits"}],children:e.jsx(i,{addonAfter:e.jsx(c,{type:"link",className:"otp-button",onClick:L,disabled:T||I,children:I?"Sent!":"Send OTP"}),variant:"borderless",maxLength:10,minLength:10,onChange:B,onKeyPress:r=>{/[0-9]/.test(r.key)||r.preventDefault()},placeholder:"Enter 10-digit mobile number",className:"otp-input"})}),e.jsx(t.Item,{label:"Enter Services",name:"services",rules:[{required:!0}],children:e.jsxs(S,{placeholder:"Select services",mode:"multiple",allowClear:!0,children:[e.jsx(u,{value:"Sports",children:"Sports"}),e.jsx(u,{value:"Gym",children:"Gym"}),e.jsx(u,{value:"Event",children:"Event"}),e.jsx(u,{value:"Coach",children:"Coach"})]})})]}),e.jsxs(b,{span:12,children:[e.jsx("h3",{children:" "}),e.jsx(t.Item,{label:"Enter Email",name:"email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(i,{})}),e.jsx(t.Item,{label:"Enter OTP",name:"otp",validateStatus:v?"error":void 0,help:v||void 0,rules:[{required:!0,message:"Please enter OTP"}],children:e.jsx(i,{onChange:Z,maxLength:6,addonAfter:e.jsx(c,{onClick:w,disabled:V||k,type:"link",className:"otp-button",children:k?"verified otp":"Verify OTP"}),variant:"borderless",className:"otp-input"})}),e.jsx(t.Item,{label:"Enter Category",name:"category",rules:[{required:!1}],children:e.jsxs(S,{placeholder:"Select category",children:[e.jsx(u,{value:"category1",children:"Run/Event"}),e.jsx(u,{value:"category2",children:"Trainer/Academy"})]})})]})]}),e.jsxs(A,{gutter:24,children:[e.jsx(b,{span:24,children:e.jsx("h3",{children:"Other Information"})}),e.jsxs(b,{span:12,children:[e.jsx(t.Item,{label:"Aadhar Number",name:"aadharNumber",rules:[{required:!0,message:"Please enter Aadhar number"},{pattern:/^[2-9]{1}[0-9]{3}\s[0-9]{4}\s[0-9]{4}$/,message:"Please enter a valid 12-digit Aadhar number (e.g. 1234 5678 9123)"}],children:e.jsx(i,{maxLength:14,placeholder:"Enter 12-digit Aadhar number",onKeyPress:r=>{/[0-9\s]/.test(r.key)||r.preventDefault()}})}),e.jsx(t.Item,{label:"GST Number",name:"gstNumber",rules:[{required:!0,message:"Please enter GST Number"},{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Please enter a valid 15-character GSTIN (e.g. 29ABCDE1234F1Z5)"}],children:e.jsx(i,{maxLength:15,placeholder:"Enter 15-digit GSTIN"})}),e.jsx(t.Item,{label:"Pancard Number",name:"pancardNumber",rules:[{required:!0,message:"Please enter Pancard number"},{pattern:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,message:"Please enter a valid PAN (e.g. ABCDE1234F)"}],children:e.jsx(i,{maxLength:10,placeholder:"Enter 10-character PAN",style:{textTransform:"uppercase"}})}),e.jsx(t.Item,{label:"Account Number",name:"accountNumber",rules:[{required:!0,message:"Please enter account number"},{pattern:/^[0-9]{9,18}$/,message:"Account number must be 9–18 digits"}],children:e.jsx(i,{maxLength:18,placeholder:"Enter bank account number",onKeyPress:r=>{/[0-9]/.test(r.key)||r.preventDefault()}})}),e.jsx(t.Item,{label:"Enter Bank Name",name:"bankName",rules:[{required:!0,message:"Please enter bank name"},{pattern:/^[A-Za-z ]{3,100}$/,message:"Bank name must be at least 3 letters and contain only alphabets"}],children:e.jsx(i,{placeholder:"Enter bank name",onKeyPress:r=>{/[A-Za-z ]/.test(r.key)||r.preventDefault()}})})]}),e.jsxs(b,{span:12,children:[e.jsx(t.Item,{label:"Upload Aadhar Document",name:"aadharDoc",rules:[{required:!0}],children:e.jsx(j,{beforeUpload:()=>!1,maxCount:1,children:e.jsxs(c,{className:"upload-btn",children:[e.jsx("img",{src:x,alt:"upload"}),"Upload Image"]})})}),e.jsx(t.Item,{label:"Upload GST Document",name:"gstDocument",rules:[{required:!0}],children:e.jsx(j,{beforeUpload:()=>!1,maxCount:1,children:e.jsxs(c,{className:"upload-btn",children:[e.jsx("img",{src:x,alt:"upload"}),"Upload Image"]})})}),e.jsx(t.Item,{label:"Upload Pancard",name:"pancardDoc",rules:[{required:!0}],children:e.jsx(j,{beforeUpload:()=>!1,maxCount:1,children:e.jsxs(c,{className:"upload-btn",children:[e.jsx("img",{src:x,alt:"upload"}),"Upload Image"]})})}),e.jsx(t.Item,{label:"IFSC Code",name:"ifscCode",rules:[{required:!0,message:"Please enter IFSC code"},{pattern:/^[A-Z]{4}0[A-Z0-9]{6}$/,message:"Enter a valid IFSC code (e.g., HDFC0001234)"}],children:e.jsx(i,{maxLength:11,placeholder:"Enter IFSC code",style:{textTransform:"uppercase"}})}),e.jsx(t.Item,{label:"Upload Bank Passbook/Canceled Cheque",name:"bankDoc",rules:[{required:!0}],children:e.jsx(j,{beforeUpload:()=>!1,maxCount:1,children:e.jsxs(c,{className:"upload-btn",children:[e.jsx("img",{src:x,alt:"upload"}),"Upload Image"]})})})]})]}),e.jsx(t.Item,{children:e.jsx("div",{className:"submit-button-wrapper",children:e.jsx(c,{type:"primary",htmlType:"submit",block:!0,className:"submit-button",loading:D||E,disabled:D||E,children:E?"Updading..":" UPDATE VENDOR"})})})]})})};export{Oe as default};
