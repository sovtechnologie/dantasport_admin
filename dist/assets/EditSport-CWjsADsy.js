import{b as D,n as H,r as x,j as r,B as j}from"./index-XzM8Cj3c.js";import{u as V,a as q,C as b}from"./useAddSportPrice-Dv7R5Su3.js";import{f as w,u as A}from"./useFetchvendorVenues-D949lnpY.js";import{u as k}from"./useFetchSport-BHoIdjHF.js";import{u as L}from"./useQuery-Beh9q-Hu.js";import{d as g}from"./index-B_VpdSuJ.js";import{F as a}from"./index-BLf5ALDk.js";import{I as d}from"./index-Vt2X7eqz.js";import{S as B}from"./index-Ci-vNBFy.js";import{T}from"./index-D0YoyXJ1.js";import{T as N}from"./index-DdiLVOL9.js";import{s as h}from"./index-Yvuj0Esb.js";import"./SearchOutlined-B0571LVy.js";import"./useMutation-CNNl5TnA.js";import"./endpointApi-onWuI-MI.js";import"./useForm-EwlPOCpB.js";import"./row-CTTWbxgc.js";import"./index-BfZvbS5e.js";import"./ExclamationCircleFilled-D7dRXMD9.js";import"./Input-BUj1c9yh.js";import"./EyeOutlined-BVmecd_y.js";import"./InfoCircleFilled-Ce5_6Fhy.js";const _=u=>L({queryKey:["fetchsportprice",u],queryFn:()=>w(u),enabled:!!u,onError:l=>{console.error("Failed to fetch sport price",l)}}),{Panel:M}=b,m=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function ue(){D(e=>e.auth.user.id);const{id:u}=H(),[l]=a.useForm(),{mutate:I}=V(),{mutate:y}=q(),{data:O,loading:K}=A(),{data:v,loading:F}=k(),{data:p,loading:W}=_({venueId:19,sportId:22});console.log("Sport Price Data:",p?.result);const P=e=>{console.log("Form wfrgerge Values:",e);const s={venueId:e.venueId,sportsId:e.selectSport,slotDuration:e.duration,startTiming:"null",endTiming:"null",minimumBookingDuration:e.minduration,courtCount:e.courtNO,description:e.description,isBookable:!0},t={venueId:e.venueId,sportId:e.selectSport,slots:f};console.log("Payload:",f),I(s,{onSuccess:o=>{o.status===200&&y(t,{onSuccess:n=>{console.log("Sport Price added:",n),l.resetFields(),c({})},onError:n=>{h.error(n?.response?.data?.message||"Failed to add sport price")}}),h.success("VenueSports created successfully")},onError:o=>{h.error(o?.response?.data?.message||"Failed to create venueSports")}}),h.success("Sport added successfully")},[i,c]=x.useState({Monday:[{startTime:null,endTime:null,price:null}],Tuesday:[],Wednesday:[],Thursday:[],Friday:[],Saturday:[],Sunday:[]});let f=[];m?.forEach(e=>{i[e]?.forEach(s=>{let t={startTime:s.startTime?.format("HH:mm"),endTime:s.endTime?.format("HH:mm"),pricePerHour:s.price};m?.forEach(o=>{t[o.toLowerCase()]=o===e}),f.push(t)})});const S=(e,s,t,o)=>{const n=[...i[e]];n[s][t]=o,c({...i,[e]:n})},C=e=>{c({...i,[e]:[...i[e],{startTime:null,endTime:null,price:null}]})},E=(e,s)=>{const t=[...i[e]];t.splice(s,1),c({...i,[e]:t})};return x.useEffect(()=>{if(p?.result?.length){const e=m.reduce((s,t)=>(s[t]=[],s),{});p.result.forEach(s=>{m.forEach(t=>{s[t.toLowerCase()]&&e[t].push({startTime:s.start_time?g(s.start_time,"HH:mm:ss"):null,endTime:s.end_time?g(s.end_time,"HH:mm:ss"):null,price:s.price?Number(s.price):null})})}),c(e)}},[p]),r.jsxs("div",{className:"add-sport-container",children:[r.jsx("h2",{className:"add-sport-title",children:"Edit Sport"}),r.jsxs(a,{layout:"vertical",onFinish:P,form:l,children:[r.jsxs("div",{className:"form-row",children:[r.jsx(a.Item,{name:"selectVenue",label:"Select Venue",rules:[{required:!0}],children:r.jsx(d,{className:"sport-Select",disabled:!0})}),r.jsx(a.Item,{name:"venueId",label:"Venue ID",rules:[{required:!0}],children:r.jsx(d,{placeholder:"Enter the venueId",disabled:!0})})]}),r.jsxs("div",{className:"form-row",children:[r.jsx(a.Item,{name:"selectSport",label:"Select Sport",rules:[{required:!0}],children:r.jsx(B,{placeholder:"Select Sport",className:"sport-Select",onChange:e=>l.setFieldsValue({selectSport:e}),loading:F,children:v?.result?.filter(e=>e.sports===1)?.sort((e,s)=>e.sports_name.localeCompare(s.sports_name))?.map(e=>r.jsx(Option,{value:e.id,children:e.sports_name},e.id))})}),r.jsx(a.Item,{name:"duration",label:"Slots Duration (mins)",rules:[{required:!0}],children:r.jsx(d,{placeholder:"Booking Duration"})})]}),r.jsxs("div",{className:"form-row",children:[r.jsx(a.Item,{name:"minduration",label:"Minimum Booking Duration",rules:[{required:!0}],children:r.jsx(d,{placeholder:"Min Booking Duration"})}),r.jsx(a.Item,{name:"courtNO",label:"Number of Courts",rules:[{required:!0}],children:r.jsx(T,{placeholder:"No. of Courts",className:"sport-Number"})})]}),r.jsx("div",{className:"form-row",children:r.jsx(a.Item,{label:"Description",name:"description",rules:[{required:!0}],children:r.jsx(d,{placeholder:"Description",className:"description-input"})})}),r.jsx("h2",{className:"add-sport-title",children:"Timing & Pricing"}),r.jsx(b,{defaultActiveKey:["Monday"],children:m?.map(e=>r.jsx(M,{header:e,children:r.jsxs("div",{className:"slot-list",children:[i[e]?.map((s,t)=>r.jsxs("div",{className:"slot-row",children:[r.jsx(N,{format:"hh:mm A",value:s.startTime,onChange:o=>S(e,t,"startTime",o),use12Hours:!0}),r.jsx(N,{format:"hh:mm A",value:s.endTime,onChange:o=>S(e,t,"endTime",o),use12Hours:!0}),r.jsx(T,{min:0,placeholder:"Price",value:s.price,onChange:o=>S(e,t,"price",o)}),r.jsx(j,{danger:!0,onClick:()=>E(e,t),className:"remove-slot-btn",children:"X"})]},t)),r.jsx(j,{onClick:()=>C(e),className:"AddSlot-btn",children:"+ Add Slot"})]})},e))}),r.jsx("div",{className:"form-submit-btn",children:r.jsx(a.Item,{children:r.jsx(j,{type:"primary",className:"update-btn",htmlType:"submit",children:"Update Time and Price"})})})]})]})}export{ue as default};
