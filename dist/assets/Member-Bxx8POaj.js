import{$ as k,a3 as te,r as l,j as e,R as _,B as M,a as Fe,b as De,a0 as ge,A as be,T as V,a4 as ze,S as ke,a2 as K,m as Ee,a5 as Te,a6 as Re}from"./index-XzM8Cj3c.js";/* empty css               */import{u as Ae}from"./useFetchvendorVenues-D949lnpY.js";import{u as Ve}from"./useQuery-Beh9q-Hu.js";import{u as re}from"./useMutation-CNNl5TnA.js";import{s as g}from"./index-Yvuj0Esb.js";import{R as Q,a as G,u as Le,P as Ue}from"./PermissionTreeView-CyYyqLcV.js";import{F as y}from"./index-BLf5ALDk.js";import{M as ae}from"./index-BTmfCYkW.js";import{I}from"./index-Vt2X7eqz.js";import{S as z}from"./index-Ci-vNBFy.js";import{U as fe}from"./index-DpVHb5nB.js";import{R as ye}from"./PlusOutlined-Dj0tFLrA.js";import{F as Be,P as qe}from"./Table-Dv9gfO7j.js";import{B as $e}from"./index-D8JKXGq0.js";import{T as Oe}from"./index-B9zQjaED.js";import{R as se}from"./EyeOutlined-BVmecd_y.js";import{R as We}from"./DeleteOutlined-Ke0rSpX_.js";import{I as Ke}from"./index-CthMyroC.js";import"./ExclamationCircleFilled-D7dRXMD9.js";import"./InfoCircleFilled-Ce5_6Fhy.js";import"./SearchOutlined-B0571LVy.js";import"./ReloadOutlined-2S6DfmwU.js";import"./index-BZS9dDwd.js";import"./useBubbleLock-B-1WFybW.js";import"./useForm-EwlPOCpB.js";import"./row-CTTWbxgc.js";import"./index-BfZvbS5e.js";import"./ActionButton-DmSr_qh1.js";import"./useClosable-B4NhgZhJ.js";import"./extendsObject-78o_rR5W.js";import"./Skeleton-BxJpOdZN.js";import"./fade-_qbex92f.js";import"./Input-BUj1c9yh.js";import"./DownloadOutlined-D_mskBw8.js";import"./progress-DW_vC4dS.js";import"./addEventListener-kraIZfrw.js";import"./index-V8rTfzId.js";const Qe=async i=>{try{return(await k.post("/vendor/members/addMembers",i,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){throw s}},Ge=async i=>{try{return(await k.post("/vendor/members/getMembersList",i,{headers:{"Content-Type":"application/json"}})).data}catch(s){throw s}},Je=async i=>{try{return(await k.put("/vendor/members/updateMembers",i,{headers:{"Content-Type":"application/json"}})).data}catch(s){throw s}},Ye=async i=>{try{const s=i instanceof FormData;return(await k.put("/vendor/members/updateMembers",i,{headers:{"Content-Type":s?"multipart/form-data":"application/json"}})).data}catch(s){throw s}},He=async i=>{try{return(await k.post("/vendor/members/getSingleMemberList",i,{headers:{"Content-Type":"application/json"}})).data}catch(s){throw s}},Xe=async i=>{try{return(await k.post("/vendor/members/addingPermission",i,{headers:{"Content-Type":"application/json"}})).data}catch(s){throw s}},Ze=async i=>{try{return(await k.put("/vendor/members/updatePermission",i,{headers:{"Content-Type":"application/json"}})).data}catch(s){throw s}},es=({venueId:i,vendorId:s})=>Ve({queryKey:["members",i,s],queryFn:async()=>{try{if(!i||!s)return console.log("âš ï¸ Missing venueId or vendorId, skipping fetch"),{result:[]};console.log("ðŸ“¤ Fetching members for:",{venueId:i,vendorId:s});const a={venueId:parseInt(i),vendorId:parseInt(s)},n=await Ge(a);if(console.log("âœ… Fetch members response:",n),n?.status===200)return n;throw new Error(n?.message||"Failed to fetch members")}catch(a){throw console.error("âŒ Fetch members error:",a),a}},enabled:!!i&&!!s,staleTime:5*60*1e3,cacheTime:10*60*1e3,retry:2,retryDelay:1e3}),ss=(i,s)=>{const a=te();return re({mutationFn:async n=>{try{console.log("ðŸ“¤ Deleting member with payload:",n);const o=await Je(n);if(console.log("âœ… Delete member response:",o),o?.status===200)return o;throw new Error(o?.message||"Failed to delete member")}catch(o){throw console.error("âŒ Delete member error:",o),o}},onSuccess:(n,o)=>{console.log("ðŸŽ‰ Member deleted successfully:",n),g.success("Member deleted successfully!"),i&&s&&a.invalidateQueries({queryKey:["members",i,s]}),a.invalidateQueries({queryKey:["members"]})},onError:n=>{console.error("âŒ Delete member failed:",n);const o=n?.response?.data?.message||n?.message||"Failed to delete member";g.error(o)}})},ts=()=>{const i=te();return re({mutationFn:async s=>{try{console.log("ðŸ“¤ Adding member with data:",{venueId:s.get("venueId"),fullName:s.get("fullName"),mobileNumber:s.get("mobileNumber"),document:s.get("document"),documentNumber:s.get("documentNumber"),type:s.get("type"),hasDocument:!!s.get("memberDoc")});const a=await Qe(s);if(console.log("âœ… Add member response:",a),a?.status===200)return a;throw new Error(a?.message||"Failed to add member")}catch(a){throw console.error("âŒ Add member error:",a),a}},onSuccess:s=>{console.log("ðŸŽ‰ Member added successfully:",s),g.success("Member added successfully!"),i.invalidateQueries({queryKey:["members"]})},onError:s=>{console.error("âŒ Add member failed:",s);let a="Failed to add member";s?.response?.data?a=s.response.data.message||a:s?.message&&(a=s.message),console.error("ðŸ“ Error details:",{status:s?.response?.status,statusText:s?.response?.statusText,data:s?.response?.data,message:a}),g.error(a)}})},{Option:$}=z,rs=({isVisible:i,onClose:s,selectedVenueId:a})=>{const[n]=y.useForm(),[o,h]=l.useState([]),[w,j]=l.useState(!1),x=ts(),N=l.useCallback(async d=>{try{j(!0),console.log("ðŸ“ Form values:",d);const p=new FormData;p.append("venueId",String(a)),p.append("fullName",d.fullName),p.append("mobileNumber",d.mobileNumber),p.append("password",d.password),p.append("document",d.document),p.append("documentNumber",d.documentNumber),p.append("type","1"),o.length>0&&o[0].originFileObj&&p.append("memberDoc",o[0].originFileObj,o[0].name),console.log("ðŸ“¤ FormData entries:");for(let[u,f]of p.entries())console.log(`  ${u}:`,f);console.log("ðŸ“¤ Submitting member data:",{venueId:a,fullName:d.fullName,mobileNumber:d.mobileNumber,document:d.document,documentNumber:d.documentNumber,hasDocument:o.length>0}),await x.mutateAsync(p),n.resetFields(),h([]),s()}catch(p){console.error("âŒ Submit error:",p)}finally{j(!1)}},[n,o,a,x,s]),P=l.useCallback(()=>{n.resetFields(),h([]),s()},[n,s]),L=({fileList:d})=>{h(d),d.length>0&&d[0].originFileObj?n.setFieldValue("memberDoc",d[0].originFileObj):n.setFieldValue("memberDoc",void 0),n.validateFields(["memberDoc"]).catch(()=>{})},F=d=>d.type.startsWith("image/")?(d.size/1024/1024<10||g.error("Image must be smaller than 10MB!"),!1):(g.error("You can only upload image files!"),!1);return e.jsx(ae,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(_,{style:{color:"#1163C7"}}),"Add New Member"]}),open:i,onCancel:P,footer:null,width:600,centered:!0,destroyOnClose:!0,children:e.jsxs(y,{form:n,layout:"vertical",onFinish:N,autoComplete:"off",className:"add-member-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsx(y.Item,{name:"fullName",label:"Full Name",rules:[{required:!0,message:"Please enter full name"},{min:2,message:"Name must be at least 2 characters"},{max:50,message:"Name must not exceed 50 characters"}],className:"form-item-half",children:e.jsx(I,{prefix:e.jsx(_,{}),placeholder:"Enter full name",size:"large"})}),e.jsx(y.Item,{name:"mobileNumber",label:"Mobile Number",rules:[{required:!0,message:"Please enter mobile number"},{pattern:/^[0-9]{10}$/,message:"Please enter a valid 10-digit mobile number"}],className:"form-item-half",children:e.jsx(I,{prefix:e.jsx(Q,{}),placeholder:"Enter mobile number",size:"large",maxLength:10})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx(y.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],className:"form-item-half",children:e.jsx(I.Password,{placeholder:"Enter password",size:"large"})}),e.jsx(y.Item,{name:"document",label:"Document Type",rules:[{required:!0,message:"Please select document type"}],className:"form-item-half",children:e.jsxs(z,{placeholder:"Select document type",size:"large",children:[e.jsx($,{value:"Aadhar",children:"Aadhar Card"}),e.jsx($,{value:"Pan",children:"PAN Card"}),e.jsx($,{value:"Driving License",children:"Driving License"}),e.jsx($,{value:"Passport",children:"Passport"}),e.jsx($,{value:"Voter ID",children:"Voter ID"})]})})]}),e.jsx(y.Item,{name:"documentNumber",label:"Document Number",rules:[{required:!0,message:"Please enter document number"},{min:5,message:"Document number must be at least 5 characters"}],children:e.jsx(I,{prefix:e.jsx(G,{}),placeholder:"Enter document number",size:"large"})}),e.jsxs(y.Item,{label:"Document Photo",name:"memberDoc",rules:[{required:!0,message:"Please upload document photo",validator:(d,p)=>o.length>0&&o[0].originFileObj?Promise.resolve():Promise.reject(new Error("Please upload document photo"))}],children:[e.jsx(fe,{listType:"picture-card",fileList:o,onChange:L,beforeUpload:F,maxCount:1,accept:"image/*",children:o.length>=1?null:e.jsxs("div",{children:[e.jsx(ye,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Document"})]})}),e.jsxs("div",{className:"upload-hint",children:[e.jsx("p",{children:"â€¢ Upload a clear photo of the document"}),e.jsx("p",{children:"â€¢ Supported formats: JPG, PNG, GIF"}),e.jsx("p",{children:"â€¢ Maximum file size: 10MB"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx(M,{type:"default",onClick:P,size:"large",disabled:w,children:"Cancel"}),e.jsx(M,{type:"primary",htmlType:"submit",size:"large",loading:w,disabled:w,children:w?"Adding Member...":"Add Member"})]})]})})},as=(i,s)=>{const a=te();return re({mutationFn:async n=>{try{console.log("ðŸ“¤ Updating member with data:",n);const o=await Ye(n);if(console.log("âœ… Update member response:",o),o?.status===200)return o;throw new Error(o?.message||"Failed to update member")}catch(o){throw console.error("âŒ Update member error:",o),o}},onSuccess:n=>{console.log("ðŸŽ‰ Member updated successfully:",n),g.success("Member updated successfully!"),i&&s&&a.invalidateQueries({queryKey:["members",i,s]}),a.invalidateQueries({queryKey:["members"]})},onError:n=>{console.error("âŒ Update member failed:",n);let o="Failed to update member";n?.response?.data?o=n.response.data.message||o:n?.message&&(o=n.message),console.error("ðŸ“ Error details:",{status:n?.response?.status,statusText:n?.response?.statusText,data:n?.response?.data,message:o}),g.error(o)}})},{Option:O}=z,ns=({isVisible:i,onClose:s,selectedMember:a,selectedVenueId:n,vendorId:o})=>{const[h]=y.useForm(),[w,j]=l.useState(!1),[x,N]=l.useState([]),P=as(n,o);l.useEffect(()=>{a&&i&&(h.setFieldsValue({fullName:a.name,mobileNumber:a.mobile,password:a.raw?.nakedPassword||"",document:a.docType,documentNumber:a.docNo}),a.docImg&&a.docImg!=="placeholder"?N([{uid:"-1",name:"current-document.jpg",status:"done",url:a.docImg}]):N([]))},[a,i,h]);const L=l.useCallback(async u=>{try{j(!0),console.log("ðŸ“ Form values:",u);const f=new FormData,b=a.raw?.user_id||a.raw?.member_id||a.id;console.log("ðŸ” Edit Member ID resolution:",{"selectedMember.raw?.user_id":a.raw?.user_id,"selectedMember.raw?.member_id":a.raw?.member_id,"selectedMember.id":a.id,"resolved memberId":b}),f.append("memberId",b),f.append("fullName",u.fullName),f.append("password",u.password),f.append("document",u.document),f.append("documentNumber",u.documentNumber),x.length>0&&x[0].originFileObj&&f.append("memberDoc",x[0].originFileObj,x[0].name),console.log("ðŸ“¤ Updating member data:",{memberId:b,fullName:u.fullName,mobileNumber:"Not editable (disabled)",document:u.document,documentNumber:u.documentNumber,hasDocument:x.length>0}),await P.mutateAsync(f),h.resetFields(),N([]),s()}catch(f){console.error("âŒ Submit error:",f)}finally{j(!1)}},[h,a,P,s,x]),F=l.useCallback(()=>{h.resetFields(),N([]),s()},[h,s]),d=({fileList:u})=>{N(u),u.length>0&&u[0].originFileObj?h.setFieldValue("memberDoc",u[0].originFileObj):h.setFieldValue("memberDoc",void 0),h.validateFields(["memberDoc"]).catch(()=>{})},p=u=>u.type.startsWith("image/")?(u.size/1024/1024<10||g.error("Image must be smaller than 10MB!"),!1):(g.error("You can only upload image files!"),!1);return e.jsx(ae,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(_,{style:{color:"#1163C7"}}),"Edit Member - ",a?.name]}),open:i,onCancel:F,footer:null,width:600,centered:!0,destroyOnClose:!0,children:e.jsxs(y,{form:h,layout:"vertical",onFinish:L,autoComplete:"off",className:"edit-member-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsx(y.Item,{name:"fullName",label:"Full Name",rules:[{required:!0,message:"Please enter full name"},{min:2,message:"Name must be at least 2 characters"},{max:50,message:"Name must not exceed 50 characters"}],className:"form-item-half",children:e.jsx(I,{prefix:e.jsx(_,{}),placeholder:"Enter full name",size:"large"})}),e.jsx(y.Item,{name:"mobileNumber",label:"Mobile Number",className:"form-item-half",help:"Mobile number cannot be changed after member creation",children:e.jsx(I,{prefix:e.jsx(Q,{}),placeholder:"Mobile number",size:"large",disabled:!0,style:{backgroundColor:"#f5f5f5",color:"#666",cursor:"not-allowed"}})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx(y.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],className:"form-item-half",children:e.jsx(I.Password,{placeholder:"Enter password",size:"large"})}),e.jsx(y.Item,{name:"document",label:"Document Type",rules:[{required:!0,message:"Please select document type"}],className:"form-item-half",children:e.jsxs(z,{placeholder:"Select document type",size:"large",children:[e.jsx(O,{value:"Aadhar",children:"Aadhar Card"}),e.jsx(O,{value:"Pan",children:"PAN Card"}),e.jsx(O,{value:"Driving License",children:"Driving License"}),e.jsx(O,{value:"Passport",children:"Passport"}),e.jsx(O,{value:"Voter ID",children:"Voter ID"})]})})]}),e.jsx(y.Item,{name:"documentNumber",label:"Document Number",rules:[{required:!0,message:"Please enter document number"},{min:5,message:"Document number must be at least 5 characters"}],children:e.jsx(I,{prefix:e.jsx(G,{}),placeholder:"Enter document number",size:"large"})}),e.jsxs(y.Item,{label:"Document Photo",name:"memberDoc",rules:[{required:!1,message:"Please upload document photo",validator:(u,f)=>(x.length>0&&x[0].originFileObj,Promise.resolve())}],children:[e.jsx(fe,{listType:"picture-card",fileList:x,onChange:d,beforeUpload:p,maxCount:1,accept:"image/*",children:x.length>=1?null:e.jsxs("div",{children:[e.jsx(ye,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Document"})]})}),e.jsxs("div",{className:"upload-hint",children:[e.jsx("p",{children:"â€¢ Upload a clear photo of the document"}),e.jsx("p",{children:"â€¢ Supported formats: JPG, PNG, GIF"}),e.jsx("p",{children:"â€¢ Maximum file size: 10MB"}),e.jsx("p",{children:"â€¢ Leave empty to keep current document"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx(M,{type:"default",onClick:F,size:"large",disabled:w,children:"Cancel"}),e.jsx(M,{type:"primary",htmlType:"submit",size:"large",loading:w,disabled:w,children:w?"Updating Member...":"Update Member"})]})]})})},{Option:xe}=z;function Os(){Fe();const i=De(t=>t.auth.user.id),[s,a]=l.useState(null),[n,o]=l.useState(1),[h,w]=l.useState(4),[j,x]=l.useState(null),[N,P]=l.useState(!1),[L,F]=l.useState(!1),[d,p]=l.useState(!1),[u,f]=l.useState(!1),[b,ne]=l.useState(null),[je,oe]=l.useState(null),[E,ie]=l.useState(!1),[T,J]=l.useState([]),[S,W]=l.useState({}),[ve,U]=l.useState({}),[we,Y]=l.useState(!1),{data:C,loading:B,error:le}=Ae(),{data:D,loading:me,error:de,refetch:ce}=es({venueId:s,vendorId:i}),Ne=ss(s,i);Le(),l.useEffect(()=>{C?.resutl?.length&&!s&&a(C.resutl[0].venue_id)},[C,s]),l.useEffect(()=>{J([]),W({}),U({})},[s]),l.useEffect(()=>{D?.result&&J([])},[D]);const ue=t=>{P(!0),a(t),o(1),setTimeout(()=>{P(!1)},500)};l.useEffect(()=>{le&&g.error("Failed to load venue list"),de&&g.error("Failed to load members list")},[le,de]);const H=l.useMemo(()=>C?.resutl?.find(t=>t.venue_id===s),[C?.resutl,s]),pe=l.useMemo(()=>D?.result?D.result.map(t=>({id:t.id??t.member_id??t.user_id,name:t.full_name,position:"Staff",mobile:t.mobile_number,docType:t.document_name,docNo:t.document_number,docImg:t.document_file||memberimage,venueId:t.venue_id||s,vendorId:t.vendor_id,raw:t})):[],[D?.result,s]),X=(n-1)*h,Z=pe.slice(X,X+h),Me=l.useCallback(()=>{if(!s){g.warning("Please select a venue first");return}p(!0)},[s]),Se=async t=>{try{x(t.id),ie(!0),console.log("ðŸ—‘ï¸ Deleting member:",t);const r=t.raw?.user_id||t.raw?.member_id;console.log("ðŸ” Member ID resolution:",{"member.raw?.user_id":t.raw?.user_id,"member.raw?.member_id":t.raw?.member_id,"member.id":t.id,"resolved memberId":r});const c={memberId:r,status:0};console.log("ðŸ“¤ Delete payload:",c),await Ne.mutateAsync(c),console.log("âœ… Delete successful")}catch(r){console.error("âŒ Delete error:",r)}finally{x(null),ie(!1)}},Ce=l.useCallback(t=>{console.log("âœï¸ Editing member:",t),oe(t),f(!0)},[]),Pe=l.useCallback(t=>{console.log("ðŸ‘ï¸ Viewing member:",t),ne(t),F(!0)},[]),he=l.useCallback((t,r)=>{const c=t?[...T,r.id]:T.filter(m=>m!==r.id);if(J(c),t&&!S[r.id]){const m=r.raw?.user_id||r.raw?.member_id||r.id;ee(m,r.id)}},[T,S]),ee=l.useCallback(async(t,r)=>{try{U(m=>({...m,[r]:!0})),console.log("ðŸ”„ Loading permissions for member:",{actualMemberId:t,tableRecordId:r});const c=await He({memberId:t});if(console.log("ðŸ“¡ API Response:",c),c.status===200&&c.result&&c.result.length>0){const m=c.result[0],R=(m.permissions||[]).map(v=>({id:v.id,name:v.name,status:v.status,create_at:v.create_at,member_id:v.member_id}));W(v=>({...v,[r]:{permissions:R,memberInfo:{user_id:m.user_id,full_name:m.full_name,venue_id:m.venue_id,venue_name:m.venue_name,member_id:m.member_id,type:m.type}}})),console.log("âœ… Loaded permissions for member:",{actualMemberId:t,tableRecordId:r},R)}else W(m=>({...m,[r]:{permissions:[],memberInfo:{user_id:t,full_name:"Unknown Member",venue_id:s,venue_name:"Unknown Venue",member_id:t,type:1}}})),console.log("âš ï¸ No permissions found for member:",{actualMemberId:t,tableRecordId:r})}catch(c){console.error("âŒ Failed to load permissions:",c),g.error("Failed to load member permissions"),W(m=>({...m,[r]:{permissions:[],memberInfo:{user_id:t,full_name:"Unknown Member",venue_id:s,venue_name:"Unknown Venue",member_id:t,type:1}}}))}finally{U(c=>({...c,[r]:!1}))}},[s]),_e=l.useCallback(async(t,r)=>{const c=Object.keys(S).find(m=>S[m]?.memberInfo?.user_id===t||S[m]?.memberInfo?.member_id===t)||t;try{U(Ie=>({...Ie,[c]:!0})),console.log("ðŸ”„ Updating permissions for member:",{actualMemberId:t,tableRecordId:c},r);const m=S[c]?.permissions?.length>0,q=S[c]?.memberInfo,R=q?.user_id||q?.member_id||t;console.log("ðŸ” Member ID resolution (following delete/update pattern):",{"input actualMemberId":t,"memberInfo.user_id":q?.user_id,"memberInfo.member_id":q?.member_id,"resolved resolvedMemberId":R});const v={memberId:parseInt(R),data:r};console.log("ðŸ“¤ Permission payload:",v);let A;if(m?(console.log("ðŸ“ Updating existing permissions..."),A=await Ze(v)):(console.log("âž• Adding new permissions..."),A=await Xe(v)),console.log("ðŸ“¡ Permission API response:",A),A.status===200||A.status===201){console.log("âœ… Permission operation successful, refreshing..."),Y(!0);try{await ee(R,c),console.log("ðŸ”„ Refreshing members list..."),await ce(),g.success(m?"Permissions updated successfully":"Permissions added successfully")}finally{Y(!1)}}else throw new Error(A.message||"Failed to update permissions")}catch(m){throw console.error("âŒ Failed to update permissions:",m),m.response?.data?.message?g.error(`Failed to update permissions: ${m.response.data.message}`):m.message?g.error(`Failed to update permissions: ${m.message}`):g.error("Failed to update permissions. Please try again."),m}finally{U(m=>({...m,[c]:!1})),Y(!1)}},[S,ee,ce]);return B?e.jsx("div",{className:"venue-card",children:e.jsxs("div",{className:"page-loading-container",children:[e.jsx(ge,{size:"large"}),e.jsx("div",{className:"page-loading-text",children:"Loading venues..."})]})}):!s||N||s&&me||s&&!D?e.jsxs("div",{className:"venue-card",children:[e.jsxs("div",{className:"venue-toolbar",children:[e.jsx(z,{placeholder:"Select Venue",className:"venue-select",loading:B,onChange:ue,value:s||void 0,disabled:B||!C?.resutl?.length,children:C?.resutl?.map(t=>e.jsx(xe,{value:t.venue_id,children:t.venue_name},t.venue_id))}),e.jsx(M,{type:"primary",className:"add-btn",disabled:!0,children:"+ Add Venue Member"})]}),e.jsx("h3",{className:"venue-title",children:H?.venue_name||"Select a venue to view members"}),e.jsxs("div",{className:"page-loading-container",children:[e.jsx(ge,{size:"large"}),e.jsx("div",{className:"page-loading-text",children:s?N?"Switching venue...":s&&!D?"Fetching venue members...":"Loading members...":"Please select a venue to view members"})]})]}):e.jsxs("div",{className:"venue-card",children:[e.jsxs("div",{className:"venue-toolbar",children:[e.jsx(z,{placeholder:"Select Venue",className:"venue-select",loading:B,onChange:ue,value:s||void 0,disabled:B||!C?.resutl?.length,children:C?.resutl?.map(t=>e.jsx(xe,{value:t.venue_id,children:t.venue_name},t.venue_id))}),e.jsxs(M,{type:"primary",className:"add-btn",disabled:!s||E,onClick:Me,children:["+ Add Venue Member",E&&e.jsx("span",{className:"processing-indicator",children:" (Processing...)"})]})]}),e.jsx("h3",{className:"venue-title",children:H?.venue_name||"Select a venue to view members"}),e.jsx("div",{className:"members-table-container",children:Z?.length>0?e.jsx(Be,{dataSource:Z,expandable:{expandedRowKeys:T,onExpand:he,expandRowByClick:!1,expandedRowRender:t=>e.jsx("div",{className:"expanded-row-content",children:e.jsx(Ue,{memberId:t.raw?.user_id||t.raw?.member_id||t.id,memberName:t.name,initialPermissions:S[t.id]||{permissions:[],memberInfo:{}},onUpdatePermissions:_e,loading:ve[t.id]||we||!1})})},columns:[{title:"Member",key:"member",width:250,render:(t,r,c)=>e.jsxs("div",{className:"member-info-cell",children:[e.jsx(be,{size:40,icon:e.jsx(_,{}),style:{backgroundColor:"#1163C7",marginRight:12}}),e.jsxs("div",{className:"member-details",children:[e.jsxs("div",{className:"member-name",children:[e.jsx(V.Text,{strong:!0,children:r.name}),e.jsx($e,{count:X+c+1,style:{backgroundColor:"#1163C7",marginLeft:8},size:"small"})]}),e.jsx("div",{className:"member-id",children:e.jsxs(V.Text,{type:"secondary",style:{fontSize:"12px"},children:["ID: ",r.raw?.custom_id||r.id]})})]})]})},{title:"Contact",key:"contact",width:150,render:(t,r)=>e.jsx("div",{className:"contact-cell",children:e.jsxs("div",{className:"contact-item",children:[e.jsx(Q,{style:{color:"#1163C7",marginRight:6}}),e.jsx(V.Text,{children:r.mobile})]})})},{title:"Document",key:"document",width:200,render:(t,r)=>e.jsx("div",{className:"document-cell",children:e.jsxs("div",{className:"document-info",children:[e.jsxs("div",{className:"document-type",children:[e.jsx(G,{style:{color:"#1163C7",marginRight:6}}),e.jsx(V.Text,{strong:!0,children:r.docType})]}),e.jsx("div",{className:"document-number",children:e.jsx(V.Text,{type:"secondary",style:{fontSize:"12px"},children:r.docNo})})]})})},{title:"Status",key:"status",width:100,render:(t,r)=>e.jsx(Oe,{color:"green",style:{borderRadius:12},children:"Active"})},{title:"Created",key:"created",width:120,render:(t,r)=>e.jsxs("div",{className:"created-cell",children:[e.jsx(ze,{style:{color:"#1163C7",marginRight:4}}),e.jsx(V.Text,{type:"secondary",style:{fontSize:"12px"},children:r.raw?.created_at?new Date(r.raw.created_at).toLocaleDateString():"N/A"})]})},{title:"Actions",key:"actions",width:160,render:(t,r)=>e.jsxs(ke,{size:"small",children:[e.jsx(K,{title:"View Details",children:e.jsx(M,{type:"text",icon:e.jsx(se,{}),size:"small",disabled:j===r.id||E,onClick:()=>Pe(r),className:"action-btn view-btn"})}),e.jsx(K,{title:"Edit Member",children:e.jsx(M,{type:"text",icon:e.jsx(Ee,{}),size:"small",disabled:j===r.id||E,onClick:()=>Ce(r),className:"action-btn edit-btn"})}),e.jsx(K,{title:"Manage Permissions",children:e.jsx(M,{type:"text",icon:e.jsx(Te,{}),size:"small",disabled:j===r.id||E,onClick:()=>he(!T.includes(r.id),r),className:`action-btn permission-btn ${T.includes(r.id)?"active":""}`})}),e.jsx(K,{title:j===r.id?"Deleting...":"Delete Member",children:e.jsx(M,{type:"text",danger:!0,icon:e.jsx(We,{}),size:"small",loading:j===r.id,disabled:j===r.id||E,onClick:()=>Se(r),className:"action-btn delete-btn"})})]})}],pagination:!1,rowKey:"id",className:"enterprise-members-table",size:"middle",loading:me}):e.jsx("div",{className:"empty-state-container",children:e.jsxs("div",{className:"empty-state-content",children:[e.jsx("div",{className:"empty-state-icon",children:e.jsx(_,{})}),e.jsx("h3",{className:"empty-state-title",children:"No Members Found"}),e.jsx("p",{className:"empty-state-description",children:`This venue doesn't have any members yet. Click the "ADD VENUE MEMBER" button to add your first member.`}),e.jsxs("div",{className:"empty-state-info",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Member Types:"}),e.jsx("span",{className:"info-value",children:"Manager, Staff, Security"})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Required Documents:"}),e.jsx("span",{className:"info-value",children:"ID Proof, Address Proof"})]})]})]})})}),Z?.length>0&&e.jsx("div",{className:"members-footer",children:e.jsx(qe,{current:n,pageSize:h,total:pe.length,onChange:t=>o(t),showSizeChanger:!1,showQuickJumper:!1,showTotal:(t,r)=>`${r[0]}-${r[1]} of ${t} members`})}),e.jsx(ae,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(_,{style:{color:"#1163C7"}}),"Member Details - ",b?.name]}),open:L,onCancel:()=>{F(!1),ne(null)},footer:null,width:"auto",centered:!0,style:{maxWidth:"90vw"},children:b&&e.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"24px",padding:"24px",background:"linear-gradient(135deg, #1163C7 0%, #0d4a9e 100%)",borderRadius:"16px",color:"white",textAlign:"center",boxShadow:"0 8px 32px rgba(17, 99, 199, 0.3)"},children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx(be,{size:80,icon:e.jsx(_,{}),style:{backgroundColor:"rgba(255, 255, 255, 0.2)",border:"3px solid rgba(255, 255, 255, 0.3)"}})}),e.jsx("h2",{style:{margin:"0 0 8px 0",color:"white",fontSize:"24px",fontWeight:"600"},children:b.name}),e.jsxs("div",{style:{display:"inline-block",padding:"6px 16px",backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"20px",fontSize:"14px",fontWeight:"500"},children:["Member ID: ",b.raw?.custom_id||b.id]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"24px"},children:[e.jsxs("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"12px",border:"1px solid #e9ecef"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px",color:"#1163C7",fontWeight:"600",fontSize:"16px"},children:[e.jsx(Q,{style:{marginRight:"8px",fontSize:"18px"}}),"Contact Information"]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#6c757d",marginBottom:"4px"},children:"Mobile Number"}),e.jsx("div",{style:{fontSize:"16px",fontWeight:"500",color:"#212529"},children:b.mobile})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",color:"#6c757d",marginBottom:"4px"},children:"Venue"}),e.jsx("div",{style:{fontSize:"16px",fontWeight:"500",color:"#212529"},children:H?.venue_name})]})]}),e.jsxs("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"12px",border:"1px solid #e9ecef"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px",color:"#1163C7",fontWeight:"600",fontSize:"16px"},children:[e.jsx(G,{style:{marginRight:"8px",fontSize:"18px"}}),"Document Information"]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#6c757d",marginBottom:"4px"},children:"Document Type"}),e.jsx("div",{style:{fontSize:"16px",fontWeight:"500",color:"#212529"},children:b.docType})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",color:"#6c757d",marginBottom:"4px"},children:"Document Number"}),e.jsx("div",{style:{fontSize:"16px",fontWeight:"500",color:"#212529",fontFamily:"monospace",backgroundColor:"#e9ecef",padding:"4px 8px",borderRadius:"4px",display:"inline-block"},children:b.docNo})]})]})]}),e.jsxs("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"12px",border:"1px solid #e9ecef",textAlign:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"16px",color:"#1163C7",fontWeight:"600",fontSize:"16px"},children:[e.jsx(se,{style:{marginRight:"8px",fontSize:"18px"}}),"Document Photo"]}),e.jsx("div",{children:b.docImg&&b.docImg!=="memberimage"?e.jsx(Ke,{src:b.docImg,alt:`${b.name} document`,style:{maxWidth:"250px",maxHeight:"250px",objectFit:"contain",border:"2px solid #e9ecef",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},preview:{mask:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"white",fontWeight:"500"},children:[e.jsx(se,{}),"Click to view full size"]})}}):e.jsxs("div",{style:{padding:"60px 40px",border:"2px dashed #dee2e6",borderRadius:"12px",color:"#6c757d",fontSize:"16px",backgroundColor:"#ffffff"},children:[e.jsx(Re,{style:{fontSize:"48px",marginBottom:"12px",display:"block"}}),"No Document Photo Available"]})})]})]})}),e.jsx(rs,{isVisible:d,onClose:()=>p(!1),selectedVenueId:s}),e.jsx(ns,{isVisible:u,onClose:()=>{f(!1),oe(null)},selectedMember:je,selectedVenueId:s,vendorId:i})]})}export{Os as default};
