import{r as n,I as b,_ as x,j as s,a0 as C,B as w}from"./index-XzM8Cj3c.js";import{s as f}from"./index-Yvuj0Esb.js";import{R as E}from"./ReloadOutlined-2S6DfmwU.js";import{R as M}from"./index-BZS9dDwd.js";var O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136V232h752v560zM610.3 476h123.4c1.3 0 2.3-3.6 2.3-8v-48c0-4.4-1-8-2.3-8H610.3c-1.3 0-2.3 3.6-2.3 8v48c0 4.4 1 8 2.3 8zm4.8 144h185.7c3.9 0 7.1-3.6 7.1-8v-48c0-4.4-3.2-8-7.1-8H615.1c-3.9 0-7.1 3.6-7.1 8v48c0 4.4 3.2 8 7.1 8zM224 673h43.9c4.2 0 7.6-3.3 7.9-7.5 3.8-50.5 46-90.5 97.2-90.5s93.4 40 97.2 90.5c.3 4.2 3.7 7.5 7.9 7.5H522a8 8 0 008-8.4c-2.8-53.3-32-99.7-74.6-126.1a111.8 111.8 0 0029.1-75.5c0-61.9-49.9-112-111.4-112s-111.4 50.1-111.4 112c0 29.1 11 55.5 29.1 75.5a158.09 158.09 0 00-74.6 126.1c-.4 4.6 3.2 8.4 7.8 8.4zm149-262c28.5 0 51.7 23.3 51.7 52s-23.2 52-51.7 52-51.7-23.3-51.7-52 23.2-52 51.7-52z"}}]},name:"idcard",theme:"outlined"},L=function(t,r){return n.createElement(b,x({},t,{ref:r,icon:O}))},A=n.forwardRef(L),H={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M877.1 238.7L770.6 132.3c-13-13-30.4-20.3-48.8-20.3s-35.8 7.2-48.8 20.3L558.3 246.8c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l89.6 89.7a405.46 405.46 0 01-86.4 127.3c-36.7 36.9-79.6 66-127.2 86.6l-89.6-89.7c-13-13-30.4-20.3-48.8-20.3a68.2 68.2 0 00-48.8 20.3L132.3 673c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l106.4 106.4c22.2 22.2 52.8 34.9 84.2 34.9 6.5 0 12.8-.5 19.2-1.6 132.4-21.8 263.8-92.3 369.9-198.3C818 606 888.4 474.6 910.4 342.1c6.3-37.6-6.3-76.3-33.3-103.4zm-37.6 91.5c-19.5 117.9-82.9 235.5-178.4 331s-213 158.9-330.9 178.4c-14.8 2.5-30-2.5-40.8-13.2L184.9 721.9 295.7 611l119.8 120 .9.9 21.6-8a481.29 481.29 0 00285.7-285.8l8-21.6-120.8-120.7 110.8-110.9 104.5 104.5c10.8 10.8 15.8 26 13.3 40.8z"}}]},name:"phone",theme:"outlined"},I=function(t,r){return n.createElement(b,x({},t,{ref:r,icon:H}))},G=n.forwardRef(I),S={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},V=function(t,r){return n.createElement(b,x({},t,{ref:r,icon:S}))},$=n.forwardRef(V);const U=()=>{const[l,t]=n.useState(!1),r=n.useCallback(async u=>{try{return t(!0),await new Promise(c=>setTimeout(c,500)),{success:!0,data:{banner:"read",payout:"write",page:"read",zone:"hide",category:"read",paymentGateway:"write"}}}catch(i){return console.error("Failed to fetch member permissions:",i),f.error("Failed to load member permissions"),{success:!1,error:i.message}}finally{t(!1)}},[]),v=n.useCallback(async(u,i)=>{try{return t(!0),await new Promise(c=>setTimeout(c,1e3)),console.log("Updating permissions for member:",u,i),{success:!0,data:i}}catch(c){return console.error("Failed to update member permissions:",c),f.error("Failed to update member permissions"),{success:!1,error:c.message}}finally{t(!1)}},[]);return{loading:l,fetchMemberPermissions:r,updateMemberPermissions:v}},_=({memberId:l,memberName:t,initialPermissions:r={},onUpdatePermissions:v,loading:u=!1})=>{const[i,c]=n.useState({}),[y,g]=n.useState(!1),[p,k]=n.useState(!1),m=[{key:"banner",label:"Banner"},{key:"payout",label:"Payout"},{key:"page",label:"Page"},{key:"zone",label:"Zone"},{key:"category",label:"Category"},{key:"paymentGateway",label:"Payment Gateway"}],j=[{key:"hide",label:"Hide",value:0},{key:"read",label:"Read",value:1},{key:"write",label:"Write",value:2}],d=r.permissions&&r.permissions.length>0;r.memberInfo,n.useEffect(()=>{if(d){const e={};m.forEach(a=>{const o=r.permissions.find(h=>h.name.toLowerCase()===a.label.toLowerCase());if(o){const h={0:"hide",1:"read",2:"write"};e[a.key]=h[o.status]||"hide"}else e[a.key]="hide"}),c(e)}else{const e={};m.forEach(a=>{e[a.key]="hide"}),c(e)}},[r,l,d]),n.useEffect(()=>{const e=Object.keys(i).some(a=>i[a]!==(r[a]||"read"));g(e)},[i,r]);const R=(e,a)=>{c(o=>({...o,[e]:a}))},P=async()=>{try{k(!0);const e=m.map(a=>{const o=i[a.key]||"hide",h=j.find(N=>N.key===o)?.value||0;return{name:a.label,status:h}});await v(l,e),g(!1),f.success("Member permissions updated successfully")}catch(e){f.error("Failed to update permissions"),console.error("Permission update error:",e)}finally{k(!1)}},z=()=>{const e={};m.forEach(a=>{e[a.key]=r[a.key]||"read"}),c(e),g(!1)};return u?s.jsxs("div",{className:"permission-treeview-loading",children:[s.jsx(C,{size:"large"}),s.jsx("div",{className:"loading-text",children:d?"Refreshing permissions...":"Loading permissions..."})]}):s.jsxs("div",{className:"permission-treeview",children:[s.jsxs("div",{className:"permission-header",children:[s.jsx("h4",{className:"permission-title",children:d?`Manage Permissions for ${t}`:`Add Role for ${t}`}),s.jsxs("div",{className:"permission-actions",children:[d&&s.jsx(w,{icon:s.jsx(E,{}),onClick:z,disabled:!y||p,size:"small",children:"Reset"}),s.jsx(w,{type:"primary",icon:s.jsx($,{}),onClick:P,disabled:!y||p,loading:p,size:"small",children:d?"UPDATE ROLE":"ADD ROLE"})]})]}),!d&&s.jsx("div",{className:"no-permissions-message",children:s.jsx("p",{children:'No permissions have been assigned to this member yet. Set the permissions below and click "ADD ROLE" to assign them.'})}),s.jsx("div",{className:"permission-grid",children:m.map((e,a)=>s.jsxs("div",{className:"permission-category",children:[s.jsx("div",{className:"category-title",children:e.label}),s.jsx("div",{className:"permission-options",children:j.map(o=>s.jsxs("div",{className:`permission-option ${i[e.key]===o.key?"selected":""}`,children:[s.jsx(M,{checked:i[e.key]===o.key,onChange:()=>R(e.key,o.key),disabled:p}),s.jsx("span",{className:"permission-label",children:o.label})]},o.key))})]},e.key))}),y&&s.jsx("div",{className:"permission-changes-indicator",children:s.jsx("span",{className:"changes-text",children:"You have unsaved changes"})})]})};export{_ as P,G as R,A as a,U as u};
