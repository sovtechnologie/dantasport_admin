import{a as L,r as S,j as r,B as j}from"./index-XzM8Cj3c.js";import{u as k,a as q,C as N}from"./useAddSportPrice-Dv7R5Su3.js";import"./index-B_VpdSuJ.js";import{u as B}from"./useFetchvendorVenues-D949lnpY.js";import{u as E}from"./useFetchSport-BHoIdjHF.js";import{F as a}from"./index-BLf5ALDk.js";import{S as g}from"./index-Ci-vNBFy.js";import{I as m}from"./index-Vt2X7eqz.js";import{T}from"./index-D0YoyXJ1.js";import{T as v}from"./index-DdiLVOL9.js";import{s as u}from"./index-Yvuj0Esb.js";import"./SearchOutlined-B0571LVy.js";import"./useMutation-CNNl5TnA.js";import"./endpointApi-onWuI-MI.js";import"./useQuery-Beh9q-Hu.js";import"./useForm-EwlPOCpB.js";import"./row-CTTWbxgc.js";import"./index-BfZvbS5e.js";import"./ExclamationCircleFilled-D7dRXMD9.js";import"./Input-BUj1c9yh.js";import"./EyeOutlined-BVmecd_y.js";import"./InfoCircleFilled-Ce5_6Fhy.js";const{Panel:H}=N,f=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function de(){const y=L(),[l]=a.useForm(),{mutate:I}=k(),{mutate:b}=q(),{data:x,loading:C}=B(),{data:F,loading:P}=E(),[V,d]=S.useState(!1),A=e=>{d(!0),console.log("Form wfrgerge Values:",e);const s={venueId:e.venueId,sportsId:e.selectSport,slotDuration:e.duration,startTiming:"null",endTiming:"null",minimumBookingDuration:e.minduration,courtCount:e.courtNO,description:e.description,isBookable:!0},t={venueId:e.venueId,sportId:e.selectSport,slots:p};console.log("Payload:",p),I(s,{onSuccess:o=>{o.status===200&&b(t,{onSuccess:i=>{console.log("Sport Price added:",i),l.resetFields(),c({}),d(!1)},onError:i=>{u.error(i?.response?.data?.message||"Failed to add sport price"),d(!1)}}),u.success("VenueSports created successfully"),y("/vendor/manage/sports")},onError:o=>{u.error(o?.response?.data?.message||"Failed to create venueSports"),d(!1)}}),u.success("Sport added successfully")},[n,c]=S.useState({Monday:[{startTime:null,endTime:null,price:null}],Tuesday:[],Wednesday:[],Thursday:[],Friday:[],Saturday:[],Sunday:[]});let p=[];f?.forEach(e=>{n[e]?.forEach(s=>{let t={startTime:s.startTime?.format("HH:mm"),endTime:s.endTime?.format("HH:mm"),pricePerHour:s.price};f?.forEach(o=>{t[o.toLowerCase()]=o===e}),p.push(t)})});const[_,M]=S.useState([]),h=(e,s,t,o)=>{const i=[...n[e]];i[s][t]=o,c({...n,[e]:i})},D=e=>{c({...n,[e]:[...n[e],{startTime:null,endTime:null,price:null}]})},w=(e,s)=>{const t=[...n[e]];t.splice(s,1),c({...n,[e]:t})};return r.jsxs("div",{className:"add-sport-container",children:[r.jsx("h2",{className:"add-sport-title",children:"Add Sport"}),r.jsxs(a,{layout:"vertical",onFinish:A,form:l,children:[r.jsxs("div",{className:"form-row",children:[r.jsx(a.Item,{name:"selectVenue",label:"Select Venue",rules:[{required:!0}],children:r.jsx(g,{placeholder:"Select Venue",className:"sport-Select",loading:C,onChange:e=>l.setFieldsValue({venueId:e}),value:x?.resutl?.[0]?.venue_id,children:x?.resutl?.map(e=>r.jsx(Option,{value:e.venue_id,children:e.venue_name},e.venue_id))})}),r.jsx(a.Item,{name:"venueId",label:"Venue ID",rules:[{required:!0}],children:r.jsx(m,{placeholder:"venueId",disabled:!0})})]}),r.jsxs("div",{className:"form-row",children:[r.jsx(a.Item,{name:"selectSport",label:"Select Sport",rules:[{required:!0}],children:r.jsx(g,{placeholder:"Select Sport",className:"sport-Select",onChange:e=>l.setFieldsValue({selectSport:e}),loading:P,showSearch:!0,optionFilterProp:"children",filterOption:(e,s)=>s.children.toLowerCase().includes(e.toLowerCase()),children:F?.result?.filter(e=>e.sports===1)?.sort((e,s)=>e.sports_name.localeCompare(s.sports_name))?.map(e=>r.jsx(Option,{value:e.id,children:e.sports_name},e.id))})}),r.jsx(a.Item,{name:"duration",label:"Slots Duration (mins)",rules:[{required:!0}],children:r.jsx(m,{placeholder:"Booking Duration"})})]}),r.jsxs("div",{className:"form-row",children:[r.jsx(a.Item,{name:"minduration",label:"Minimum Booking Duration",rules:[{required:!0}],children:r.jsx(m,{placeholder:"Min Booking Duration"})}),r.jsx(a.Item,{name:"courtNO",label:"Number of Courts",rules:[{required:!0}],children:r.jsx(T,{placeholder:"No. of Courts",className:"sport-Number"})})]}),r.jsx("div",{className:"form-row",children:r.jsx(a.Item,{label:"Description",name:"description",rules:[{required:!0}],children:r.jsx(m,{placeholder:"Description",className:"description-input"})})}),r.jsx("h2",{className:"add-sport-title",children:"Timing & Pricing"}),r.jsx(N,{defaultActiveKey:["Monday"],children:f?.map(e=>r.jsx(H,{header:e,children:r.jsxs("div",{className:"slot-list",children:[n[e]?.map((s,t)=>r.jsxs("div",{className:"slot-row",children:[r.jsx(v,{format:"hh:mm A",value:s.startTime,onChange:o=>h(e,t,"startTime",o),use12Hours:!0}),r.jsx(v,{format:"hh:mm A",value:s.endTime,onChange:o=>h(e,t,"endTime",o),use12Hours:!0}),r.jsx(T,{min:0,placeholder:"Price",value:s.price,onChange:o=>h(e,t,"price",o)}),r.jsx(j,{danger:!0,onClick:()=>w(e,t),className:"remove-slot-btn",children:"X"})]},t)),r.jsx(j,{onClick:()=>D(e),className:"AddSlot-btn",children:"+ Add Slot"})]})},e))}),r.jsx("div",{className:"form-submit-btn",children:r.jsx(a.Item,{children:r.jsx(j,{type:"primary",className:"update-btn",htmlType:"submit",loading:V,children:"Update Time and Price"})})})]})]})}export{de as default};
