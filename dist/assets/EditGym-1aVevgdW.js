import{a as R,d as J,n as Y,r as c,j as i,a0 as D,B as j}from"./index-XzM8Cj3c.js";/* empty css                   */import{u as T}from"./UploadIcon-DVASWBXr.js";import{G as $}from"./GooglePlacesAutocomplete-BY2BgwQL.js";import{c as K,e as Q,g as X}from"./useFetchvendorVenues-D949lnpY.js";import{d as k}from"./index-B_VpdSuJ.js";import{F as n}from"./index-BLf5ALDk.js";import{T as Z}from"./index-DdiLVOL9.js";import{I as d}from"./index-Vt2X7eqz.js";import{U as w}from"./index-DpVHb5nB.js";import{R as u}from"./index-BZS9dDwd.js";import{S as ee}from"./index-Ci-vNBFy.js";import{T as ie}from"./index-D0YoyXJ1.js";import{s as b}from"./index-Yvuj0Esb.js";import"./useQuery-Beh9q-Hu.js";import"./useMutation-CNNl5TnA.js";import"./SearchOutlined-B0571LVy.js";import"./useForm-EwlPOCpB.js";import"./row-CTTWbxgc.js";import"./index-BfZvbS5e.js";import"./ExclamationCircleFilled-D7dRXMD9.js";import"./Input-BUj1c9yh.js";import"./EyeOutlined-BVmecd_y.js";import"./fade-_qbex92f.js";import"./DeleteOutlined-Ke0rSpX_.js";import"./DownloadOutlined-D_mskBw8.js";import"./progress-DW_vC4dS.js";import"./useBubbleLock-B-1WFybW.js";import"./InfoCircleFilled-Ce5_6Fhy.js";const{TextArea:I}=d;function ke(){const[r]=n.useForm(),{RangePicker:S}=Z,V=R(),f=J(),{id:A}=Y();f.state?.gymData;const[s,G]=c.useState(null),[E,N]=c.useState(!1),[y,_]=c.useState([]),[h,F]=c.useState([]),[v,P]=c.useState({latitude:18.5204,longitude:73.8567}),{data:L}=K(),m=L?.resutl||[],{data:p,isLoading:O}=Q(A),U=X(),C=e=>{if(console.log("Raw API response:",e),!e)return null;const t=a=>Array.isArray(a)?a[0]:a;if(e.result){const a=t(e.result);return console.log("Extracted from resp.result:",a),a}if(e.data?.result){const a=t(e.data.result);return console.log("Extracted from resp.data.result:",a),a}return e.data&&(e.data.gym_name||e.data.gymName)?(console.log("Extracted from resp.data:",e.data),e.data):e.gym_name||e.gymName?(console.log("Extracted direct object:",e),e):(console.log("Could not extract gym data from:",e),null)};c.useEffect(()=>{if(f.state?.gymData){const e=f.state.gymData;G(e),console.log("Setting gym data from location state:",e)}},[f.state]),c.useEffect(()=>{if(s){console.log("Setting form values from gym data:",s),r.setFieldsValue({gymName:s.gym_name||s.gymName||"",aboutGym:s.about_gym||s.aboutGym||"",onlyWomen:Number(s.only_women)===1||s.onlyWomen===!0?"yes":"no",isBookable:Number(s.is_bookable)===1||s.isBookable===!0?"yes":"no",fullAddress:s.full_address||s.fullAddress||"",state:s.state||"",city:s.city||"",area:s.area||"",pincode:s.pincode||s.pin_code||s.postal_code||s.zipcode||"",termAndConditions:s.term_and_conditions||s.termAndConditions||"",cancellationPolicy:s.cancellation_policy||s.cancellationPolicy||"",latitude:s.lat||s.latitude||void 0,longitude:s.lng||s.longitude||void 0,timing:s.start_time&&s.end_time||s.startTime&&s.endTime?[k(s.start_time||s.startTime,"HH:mm"),k(s.end_time||s.endTime,"HH:mm")]:void 0}),console.log("🔍 Form values set from gymData:",{pincode:s.pincode||s.pin_code||s.postal_code||s.zipcode||"",allSetValues:{gymName:s.gym_name||s.gymName||"",pincode:s.pincode||s.pin_code||s.postal_code||s.zipcode||""}});const e=s.lat||s.latitude,t=s.lng||s.longitude;e&&t&&P({latitude:parseFloat(e),longitude:parseFloat(t)});const a=s.mobile_image||s.mobileImage||null,o=s.desktop_image||s.desktopImage||null;a&&_([{uid:"mobile-1",name:"mobile-cover.jpg",status:"done",url:a}]),o&&F([{uid:"desktop-1",name:"desktop-cover.jpg",status:"done",url:o}])}},[s,r]),c.useEffect(()=>{if(s&&p){const e=C(p);if(e){console.log("Processing API response data:",e);const t={};e.price!==void 0&&e.price!==null&&(t.passPrice=Number(e.price),console.log("Setting passPrice from API:",t.passPrice)),console.log("🔍 Checking pincode in API response:",{pincode:e.pincode,pin_code:e.pin_code,postal_code:e.postal_code,zipcode:e.zipcode,allKeys:Object.keys(e)});const a=e.pincode||e.pin_code||e.postal_code||e.zipcode||"";console.log("🔍 Extracted pincode value:",a),a?(t.pincode=a,console.log("✅ Setting pincode from API:",a)):console.log("❌ No pincode found in API response"),Object.keys(t).length>0?(r.setFieldsValue(t),console.log("🔍 API fields set:",t)):(console.log("🔍 No API fields to set, testing pincode manually..."),r.setFieldsValue({pincode:"123456"}),console.log("🧪 Test pincode set: 123456"))}}},[s,p,r]),c.useEffect(()=>{if(s&&p&&m.length>0){const e=C(p);if(e){console.log("🔍 Processing amenities from API response:",e),console.log("🔍 Available amenities options:",m),console.log("🔍 All keys in API response:",Object.keys(e)),console.log("🔍 Full API response structure:",JSON.stringify(e,null,2));let t=[];const a=e.amenities||e.amenitiesIds||e.amenities_ids||e.amenities_list;if(console.log("🔍 Has amenities in API response:",a),console.log("🔍 Checking for amenities_ids specifically:",e.amenities_ids),Array.isArray(e.amenities_ids)?(console.log("✅ Found amenities_ids array (your format):",e.amenities_ids),t=e.amenities_ids):Array.isArray(e.amenities)?(console.log("✅ Found amenities array:",e.amenities),t=e.amenities.map(o=>typeof o=="object"&&o!==null?o.id||o.amenities_id||o.amenity_id||o.value:o)):Array.isArray(e.amenitiesIds)?(console.log("✅ Found amenitiesIds array:",e.amenitiesIds),t=e.amenitiesIds):e.amenities_list&&Array.isArray(e.amenities_list)?(console.log("✅ Found amenities_list array:",e.amenities_list),t=e.amenities_list):(console.log("❌ No amenities found in API response"),console.log("🔍 Checking if amenities exist in gymData from navigation state..."),s.amenities||s.amenitiesIds||s.amenities_ids?(console.log("✅ Found amenities in gymData from navigation state"),Array.isArray(s.amenities_ids)?(console.log("✅ Found amenities_ids in gymData:",s.amenities_ids),t=s.amenities_ids):Array.isArray(s.amenities)?t=s.amenities.map(o=>typeof o=="object"&&o!==null?o.id||o.amenities_id||o.amenity_id||o.value:o):Array.isArray(s.amenitiesIds)&&(t=s.amenitiesIds)):console.log("❌ No amenities found in gymData either")),t=t.map(o=>{const l=Number(o);return!isNaN(l)&&l>0?l:null}).filter(o=>o!==null),console.log("🔍 Final amenities IDs to set:",t),t.length>0){const o=t.filter(l=>m.some(g=>g.id===l));if(console.log("🔍 Valid amenities IDs (exist in options):",o),o.length>0)r.setFieldsValue({amenities:o}),console.log("✅ Amenities set successfully:",o),setTimeout(()=>{const l=r.getFieldsValue();console.log("🔍 Current form values after setting amenities:",l),console.log("🔍 Current amenities value:",l.amenities)},100);else if(console.log("❌ No valid amenities IDs found in options"),console.log("🔍 Available option IDs:",m.map(l=>l.id)),m.length>=3){const l=[5,4,3];console.log("🧪 Testing with your exact amenities_ids format:",l),r.setFieldsValue({amenities:l}),console.log("🧪 Test amenities_ids set, check if form shows selection")}}else if(console.log("❌ No amenities IDs extracted from any source"),m.length>0){const o=[m[0].id];console.log("🧪 Testing with first available amenity ID:",o),r.setFieldsValue({amenities:o}),console.log("🧪 Test amenities set, check if form shows selection")}}}else console.log("🔍 Missing dependencies:",{gymData:!!s,gymResp:!!p,amenitiesOptionsLength:m.length})},[s,p,m,r]),c.useEffect(()=>{const e=r.getFieldsValue();console.log("🔍 Form values changed:",e),e.amenities&&console.log("🔍 Amenities field value:",e.amenities)},[r]);const q=`https://maps.google.com/maps?q=${v.latitude},${v.longitude}&z=15&output=embed`,H=({fileList:e})=>_(e),z=({fileList:e})=>F(e),W=({address:e,area:t,city:a,state:o,pincode:l,latitude:g,longitude:x,search:B})=>{r.setFieldsValue({fullAddress:e,area:t,city:a,state:o,pincode:l,latitude:g,longitude:x,search:B}),g&&x&&P({latitude:g,longitude:x})},M=async e=>{try{N(!0);const t=new FormData;y[0]?.originFileObj&&t.append("mobileImage",y[0].originFileObj),h[0]?.originFileObj&&t.append("desktopImage",h[0].originFileObj),t.append("gymName",e.gymName),t.append("aboutGym",e.aboutGym||""),t.append("onlyWomen",e.onlyWomen==="yes"),t.append("lat",e.latitude||""),t.append("lng",e.longitude||""),t.append("fullAddress",e.fullAddress||""),t.append("state",e.state||""),t.append("city",e.city||""),t.append("area",e.area||""),t.append("pincode",e.pincode||""),t.append("termAndConditions",e.termAndConditions||""),t.append("cancellationPolicy",e.cancellationPolicy||""),t.append("amenitiesType","gym"),e.timing&&e.timing.length===2&&(t.append("startTime",e.timing[0].format("HH:mm")),t.append("endTime",e.timing[1].format("HH:mm"))),t.append("isBookable",e.isBookable==="yes");const a=[{passes_name:"One day passes",price:Number(e.passPrice||0)}];t.append("gymPasses",JSON.stringify(a)),e.amenities?.length&&t.append("amenities",JSON.stringify(e.amenities));const o=await U.mutateAsync({gymId:A,formData:t});o?.status===200?(b.success("Gym updated successfully"),V("/vendor/gym/list")):b.error(o?.message||"Failed to update gym")}catch(t){b.error(t?.message||"Failed to update gym")}finally{N(!1)}};return s?O?i.jsxs("div",{className:"venue-card",style:{display:"flex",alignItems:"center",justifyContent:"center",height:240,flexDirection:"column"},children:[i.jsx(D,{size:"large"}),i.jsx("div",{style:{marginTop:16,color:"#666"},children:"Loading gym details..."})]}):i.jsx("div",{className:"venue-info-container",children:i.jsxs(n,{form:r,layout:"vertical",onFinish:M,children:[i.jsx("div",{className:"section-title",children:"GYM Information"}),i.jsxs("div",{className:"Venue-form-row",children:[i.jsx(n.Item,{name:"gymName",label:"Gym Name",rules:[{required:!0}],children:i.jsx(d,{placeholder:"Enter gym name"})}),i.jsx(n.Item,{name:"coverMobile",label:"Upload Cover Image For Mobile App",children:i.jsx(w,{accept:"image/*",beforeUpload:()=>!1,maxCount:1,listType:"text",fileList:y,onChange:H,children:i.jsxs(j,{className:"uploadImg",children:[i.jsx("img",{src:T,alt:"upload"})," Upload Cover Image"]})})})]}),i.jsx("div",{className:"Venue-form-row",children:i.jsx(n.Item,{name:"aboutGym",label:"Add About Gym",rules:[{required:!0}],children:i.jsx(I,{rows:5,placeholder:"Describe your gym..."})})}),i.jsxs("div",{className:"Venue-form-row",children:[i.jsx(n.Item,{name:"onlyWomen",label:"Only Women?",initialValue:"no",children:i.jsxs(u.Group,{children:[i.jsx(u,{value:"yes",className:"radio-btn",children:"Yes"}),i.jsx(u,{value:"no",className:"radio-btn",children:"No"})]})}),i.jsx(n.Item,{name:"amenities",label:"Amenities",rules:[{required:!0}],children:i.jsx(ee,{mode:"multiple",placeholder:"select amenities",options:m.map(e=>({label:e.amenities_name,value:e.id})),optionFilterProp:"label",allowClear:!0})})]}),i.jsxs("div",{className:"Venue-form-row",children:[i.jsx(n.Item,{name:"isBookable",label:"Is Bookable?",rules:[{required:!0}],children:i.jsxs(u.Group,{children:[i.jsx(u,{value:"yes",className:"radio-btn",children:"Yes"}),i.jsx(u,{value:"no",className:"radio-btn",children:"No"})]})}),i.jsx(n.Item,{name:"timing",label:"Timing",children:i.jsx(S,{format:"HH:mm",minuteStep:5})})]}),i.jsx("div",{className:"Venue-form-row",children:i.jsx(n.Item,{name:"coverWeb",label:"Upload Cover Image For Website",children:i.jsx(w,{accept:"image/*",beforeUpload:()=>!1,maxCount:1,listType:"text",fileList:h,onChange:z,children:i.jsxs(j,{className:"uploadImg",children:[i.jsx("img",{src:T,alt:"upload"})," Upload Cover Image"]})})})}),i.jsx("div",{className:"section-title",children:"Location Info"}),i.jsxs("div",{className:"location-container",children:[i.jsxs("div",{className:"location-form",children:[i.jsx("div",{className:"Venue-form-row",children:i.jsx(n.Item,{name:"fullAddress",label:"Enter Full Address",rules:[{required:!0}],children:i.jsx(d,{})})}),i.jsxs("div",{className:"Venue-form-row",children:[i.jsx(n.Item,{name:"area",label:"Area",rules:[{required:!0}],children:i.jsx(d,{})}),i.jsx(n.Item,{name:"city",label:"City",rules:[{required:!0}],children:i.jsx(d,{})})]}),i.jsxs("div",{className:"Venue-form-row",children:[i.jsx(n.Item,{name:"state",label:"State",rules:[{required:!0}],children:i.jsx(d,{})}),i.jsx(n.Item,{name:"pincode",label:"Pincode",rules:[{required:!0}],children:i.jsx(d,{})})]}),i.jsx(n.Item,{name:"passPrice",label:"Price (Per Day passes)",rules:[{required:!0}],children:i.jsx(ie,{style:{width:"100%"},placeholder:"Eg: 250"})}),i.jsx(n.Item,{name:"termAndConditions",label:"Terms & Conditions",children:i.jsx(I,{rows:3})}),i.jsx(n.Item,{name:"cancellationPolicy",label:"Cancellation Policy",children:i.jsx(I,{rows:3})})]}),i.jsxs("div",{className:"map-side",children:[i.jsxs("div",{className:"Venue-form-row",children:[i.jsx(n.Item,{name:"search",label:"Search for a location",children:i.jsx($,{onPlaceSelect:W,placeholder:"Search your address"})}),i.jsx(n.Item,{name:"latitude",hidden:!0,children:i.jsx(d,{})}),i.jsx(n.Item,{name:"longitude",hidden:!0,children:i.jsx(d,{})})]}),i.jsxs("div",{className:"map-container",children:[i.jsx("p",{className:"map-label",children:"Location"}),i.jsx("iframe",{title:"map",src:q,width:"100%",height:"220",style:{border:"1px solid #ccc",borderRadius:8},loading:"lazy"})]})]})]}),i.jsx(n.Item,{className:"centered-submit",children:i.jsx(j,{type:"primary",htmlType:"submit",loading:E,children:"UPDATE"})})]})}):i.jsxs("div",{className:"venue-card",style:{display:"flex",alignItems:"center",justifyContent:"center",height:240,flexDirection:"column"},children:[i.jsx(D,{size:"large"}),i.jsx("div",{style:{marginTop:16,color:"#666"},children:"Loading gym data..."})]})}export{ke as default};
